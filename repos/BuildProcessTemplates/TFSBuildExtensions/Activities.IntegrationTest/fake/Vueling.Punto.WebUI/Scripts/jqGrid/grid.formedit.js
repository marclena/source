(function(n){var t=null;n.jgrid.extend({searchGrid:function(t){return t=n.extend({recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,multipleSearch:!1,cloneSearchRowOnAdd:!0,sopt:null,stringResult:undefined,onClose:null,useDataProxy:!1,overlay:!0},n.jgrid.search,t||{}),this.each(function(){function a(t,i){var r=t.p.postData[i.sFilter];if(typeof r=="string"&&(r=n.jgrid.parse(r)),r&&(r.groupOp&&t.SearchFilter.setGroupOp(r.groupOp),r.rules))for(var u,f=0,o=r.rules.length,e=!1;f<o;f++)u=r.rules[f],u.field!==undefined&&u.op!==undefined&&u.data!==undefined&&(e=t.SearchFilter.setFilter({sfref:t.SearchFilter.$.find(".sf:last"),filter:n.extend({},u)}),e&&t.SearchFilter.add())}function p(r){var o=r!==undefined,e=n("#"+u.p.id),f={};t.multipleSearch===!1?(f[t.sField]=r.rules[0].field,f[t.sValue]=r.rules[0].data,f[t.sOper]=r.rules[0].op):f[t.sFilter]=r;e[0].p.search=o;n.extend(e[0].p.postData,f);e.trigger("reloadGrid",[{page:1}]);t.closeAfterSearch&&s(n("#"+i))}function w(r){var f=r&&r.hasOwnProperty("reload")?r.reload:!0;grid=n("#"+u.p.id);sdata={};grid[0].p.search=!1;t.multipleSearch===!1?sdata[t.sField]=sdata[t.sValue]=sdata[t.sOper]="":sdata[t.sFilter]="";n.extend(grid[0].p.postData,sdata);f&&grid.trigger("reloadGrid",[{page:1}]);t.closeAfterReset&&s(n("#"+i))}function s(i){if(t.onClose){var r=t.onClose(i);if(typeof r=="boolean"&&!r)return}i.hide();t.overlay===!0&&n(".jqgrid-overlay:first","#gbox_"+u.p.id).hide()}function l(){var r=n(".ui-searchFilter").length,f;r>1&&(f=n("#"+i).css("zIndex"),n("#"+i).css({zIndex:parseInt(f,10)+r}));n("#"+i).show();t.overlay===!0&&n(".jqgrid-overlay:first","#gbox_"+u.p.id).show();try{n(":input:visible","#"+i)[0].focus()}catch(e){}}var u=this,i;if(u.grid&&n.fn.searchFilter)if(i="fbox_"+u.p.id,t.recreateFilter===!0&&n("#"+i).remove(),n("#"+i).html()!=null)n.isFunction(t.beforeShowSearch)&&t.beforeShowSearch(n("#"+i)),l(),n.isFunction(t.afterShowSearch)&&t.afterShowSearch(n("#"+i));else{var h=[],v=n("#"+u.p.id).jqGrid("getGridParam","colNames"),y=n("#"+u.p.id).jqGrid("getGridParam","colModel"),e=["eq","ne","lt","le","gt","ge","bw","bn","in","ni","ew","en","cn","nc"],r,o,f,c=[];if(t.sopt!==null)for(f=0,r=0;r<t.sopt.length;r++)(o=n.inArray(t.sopt[r],e))!=-1&&(c[f]={op:t.sopt[r],text:t.odata[o]},f++);else for(r=0;r<e.length;r++)c[r]={op:e[r],text:t.odata[r]};if(n.each(y,function(i,u){var p=typeof u.search=="undefined"?!0:u.search,w=u.hidden===!0,s=n.extend({},{text:v[i],itemval:u.index||u.name},this.searchoptions),b=s.searchhidden===!0,c,a,y,l;if(typeof s.sopt!="undefined"&&(f=0,s.ops=[],s.sopt.length>0))for(r=0;r<s.sopt.length;r++)(o=n.inArray(s.sopt[r],e))!=-1&&(s.ops[f]={op:s.sopt[r],text:t.odata[o]},f++);if(typeof this.stype=="undefined"&&(this.stype="text"),this.stype=="select"&&s.dataUrl===undefined&&(s.value?c=s.value:this.editoptions&&(c=this.editoptions.value),c))if(s.dataValues=[],typeof c=="string")for(a=c.split(";"),r=0;r<a.length;r++)y=a[r].split(":"),s.dataValues[r]={value:y[0],text:y[1]};else if(typeof c=="object"){r=0;for(l in c)c.hasOwnProperty(l)&&(s.dataValues[r]={value:l,text:c[l]},r++)}(b&&p||p&&!w)&&h.push(s)}),h.length>0){if(n("<div id='"+i+"' role='dialog' tabindex='-1'><\/div>").insertBefore("#gview_"+u.p.id),t.stringResult===undefined&&(t.stringResult=t.multipleSearch),u.SearchFilter=n("#"+i).searchFilter(h,{groupOps:t.groupOps,operators:c,onClose:s,resetText:t.Reset,searchText:t.Find,windowTitle:t.caption,rulesText:t.rulesText,matchText:t.matchText,onSearch:p,onReset:w,stringResult:t.stringResult,ajaxSelectOptions:n.extend({},n.jgrid.ajaxOptions,u.p.ajaxSelectOptions||{}),clone:t.cloneSearchRowOnAdd}),n(".ui-widget-overlay","#"+i).remove(),u.p.direction=="rtl"&&n(".ui-closer","#"+i).css("float","left"),t.drag===!0)if(n("#"+i+" table thead tr:first td:first").css("cursor","move"),jQuery.fn.jqDrag)n("#"+i).jqDrag(n("#"+i+" table thead tr:first td:first"));else try{n("#"+i).draggable({handle:n("#"+i+" table thead tr:first td:first")})}catch(b){}if(t.multipleSearch===!1&&(n(".ui-del, .ui-add, .ui-del, .ui-add-last, .matchText, .rulesText","#"+i).hide(),n("select[name='groupOp']","#"+i).hide()),t.multipleSearch===!0&&t.loadDefaults===!0&&a(u,t),n.isFunction(t.onInitializeSearch))t.onInitializeSearch(n("#"+i));n.isFunction(t.beforeShowSearch)&&t.beforeShowSearch(n("#"+i));l();n.isFunction(t.afterShowSearch)&&t.afterShowSearch(n("#"+i));t.closeOnEscape===!0&&n("#"+i).keydown(function(t){t.which==27&&s(n("#"+i))})}}})},editGridRow:function(i,r){return r=n.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:!1,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0},n.jgrid.edit,r||{}),t=r,this.each(function(){function vt(t,i){t===0?n("#pData","#"+f+"_2").addClass("ui-state-disabled"):n("#pData","#"+f+"_2").removeClass("ui-state-disabled");t==i?n("#nData","#"+f+"_2").addClass("ui-state-disabled"):n("#nData","#"+f+"_2").removeClass("ui-state-disabled")}function yt(){var t=n(e).jqGrid("getDataIDs"),i=n("#id_g","#"+f).val(),r=n.inArray(i,t);return[r,t]}function l(){var i=!0;return n("#FormError","#"+f).hide(),t.checkOnUpdate&&(u={},c={},dt(),d=n.extend({},u,c),g=gt(d,t._savedData),g&&(n("#"+o).data("disabled",!0),n(".confirm","#"+s.themodal).show(),i=!1)),i}function dt(){return n(".FormElement","#"+f).each(function(){var r=n(".customelement",this),o,t,s,i;if(r.length)o=r[0],t=n(o).attr("name"),n.each(e.p.colModel,function(){if(this.name==t&&this.editoptions&&n.isFunction(this.editoptions.custom_value)){try{if(u[t]=this.editoptions.custom_value(n("#"+t,"#"+f),"get"),u[t]===undefined)throw"e1";}catch(i){i=="e1"?info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+n.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose):info_dialog(jQuery.jgrid.errors.errcap,i.message,jQuery.jgrid.edit.bClose)}return!0}});else{switch(n(this).get(0).type){case"checkbox":n(this).attr("checked")?u[this.name]=n(this).val():(s=n(this).attr("offval"),u[this.name]=s);break;case"select-one":u[this.name]=n("option:selected",this).val();c[this.name]=n("option:selected",this).text();break;case"select-multiple":u[this.name]=n(this).val();u[this.name]=u[this.name]?u[this.name].join(","):"";i=[];n("option:selected",this).each(function(t,r){i[t]=n(r).text()});c[this.name]=i.join(",");break;case"password":case"text":case"textarea":case"button":u[this.name]=n(this).val()}e.p.autoencode&&(u[this.name]=n.jgrid.htmlEncode(u[this.name]))}}),!0}function ri(i,r,u,f){for(var y,s,v,h,c=0,o,p,l,w=[],a=!1,b="",k=1;k<=f;k++)b+="<td class='CaptionTD ui-widget-content'>&#160;<\/td><td class='DataTD ui-widget-content' style='white-space:pre'>&#160;<\/td>";return i!="_empty"&&(a=n(r).jqGrid("getInd",i)),n(r.p.colModel).each(function(y){var nt;if(s=this.name,v=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1,p=v?"style='display:none'":"",s!=="cb"&&s!=="subgrid"&&this.editable===!0&&s!=="rn"){if(a===!1)o="";else if(s==r.p.ExpandColumn&&r.p.treeGrid===!0)o=n("td:eq("+y+")",r.rows[a]).text();else try{o=n.unformat(n("td:eq("+y+")",r.rows[a]),{rowId:i,colModel:this},y)}catch(it){o=n("td:eq("+y+")",r.rows[a]).html()}var d=n.extend({},this.editoptions||{},{id:s,name:s}),k=n.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),g=parseInt(k.rowpos,10)||c+1,tt=parseInt((parseInt(k.colpos,10)||1)*2,10);i=="_empty"&&d.defaultValue&&(o=n.isFunction(d.defaultValue)?d.defaultValue():d.defaultValue);this.edittype||(this.edittype="text");e.p.autoencode&&(o=n.jgrid.htmlDecode(o));l=createEl(this.edittype,d,o,!1,n.extend({},n.jgrid.ajaxOptions,r.p.ajaxSelectOptions||{}));o==""&&this.edittype=="checkbox"&&(o=n(l).attr("offval"));o==""&&this.edittype=="select"&&(o=n("option:eq(0)",l).text());(t.checkOnSubmit||t.checkOnUpdate)&&(t._savedData[s]=o);n(l).addClass("FormElement");h=n(u).find("tr[rowpos="+g+"]");k.rowabove&&(nt=n("<tr><td class='contentinfo' colspan='"+f*2+"'>"+k.rowcontent+"<\/td><\/tr>"),n(u).append(nt),nt[0].rp=g);h.length===0&&(h=n("<tr "+p+" rowpos='"+g+"'><\/tr>").addClass("FormData").attr("id","tr_"+s),n(h).append(b),n(u).append(h),h[0].rp=g);n("td:eq("+(tt-2)+")",h[0]).html(typeof k.label=="undefined"?r.p.colNames[y]:k.label);n("td:eq("+(tt-1)+")",h[0]).append(k.elmprefix).append(l).append(k.elmsuffix);w[c]=y;c++}}),c>0&&(y=n("<tr class='FormData' style='display:none'><td class='CaptionTD'><\/td><td colspan='"+(f*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+r.p.id+"_id' value='"+i+"'/><\/td><\/tr>"),y[0].rp=c+999,n(u).append(y),(t.checkOnSubmit||t.checkOnUpdate)&&(t._savedData[r.p.id+"_id"]=i)),w}function ft(i,r,u){var o,p=0,s,h,a,l,v,c,y;if((t.checkOnSubmit||t.checkOnUpdate)&&(t._savedData={},t._savedData[r.p.id+"_id"]=i),c=r.p.colModel,i=="_empty"){n(c).each(function(){o=this.name;a=n.extend({},this.editoptions||{});h=n("#"+n.jgrid.jqID(o),"#"+u);h[0]!=null&&(l="",a.defaultValue?(l=n.isFunction(a.defaultValue)?a.defaultValue():a.defaultValue,h[0].type=="checkbox"?(v=l.toLowerCase(),v.search(/(false|0|no|off|undefined)/i)<0&&v!==""?(h[0].checked=!0,h[0].defaultChecked=!0,h[0].value=l):h.attr({checked:"",defaultChecked:""})):h.val(l)):h[0].type=="checkbox"?(h[0].checked=!1,h[0].defaultChecked=!1,l=n(h).attr("offval")):h[0].type&&h[0].type.substr(0,6)=="select"?h[0].selectedIndex=0:h.val(l),(t.checkOnSubmit===!0||t.checkOnUpdate)&&(t._savedData[o]=l))});n("#id_g","#"+u).val(i);return}(y=n(r).jqGrid("getInd",i,!0),y)&&(n("td",y).each(function(f){var h,l,v;if(o=c[f].name,o!=="cb"&&o!=="subgrid"&&o!=="rn"&&c[f].editable===!0){if(o==r.p.ExpandColumn&&r.p.treeGrid===!0)s=n(this).text();else try{s=n.unformat(this,{rowId:i,colModel:c[f]},f)}catch(y){s=n(this).html()}e.p.autoencode&&(s=n.jgrid.htmlDecode(s));(t.checkOnSubmit===!0||t.checkOnUpdate)&&(t._savedData[o]=s);o=n.jgrid.jqID(o);switch(c[f].edittype){case"password":case"text":case"button":case"image":n("#"+o,"#"+u).val(s);break;case"textarea":(s=="&nbsp;"||s=="&#160;"||s.length==1&&s.charCodeAt(0)==160)&&(s="");n("#"+o,"#"+u).val(s);break;case"select":h=s.split(",");h=n.map(h,function(t){return n.trim(t)});n("#"+o+" option","#"+u).each(function(){this.selected=c[f].editoptions.multiple||h[0]!=n.trim(n(this).text())&&h[0]!=n.trim(n(this).val())?c[f].editoptions.multiple?n.inArray(n.trim(n(this).text()),h)>-1||n.inArray(n.trim(n(this).val()),h)>-1?!0:!1:!1:!0});break;case"checkbox":s=s+"";c[f].editoptions&&c[f].editoptions.value?(l=c[f].editoptions.value.split(":"),l[0]==s?(n("#"+o,"#"+u).attr("checked",!0),n("#"+o,"#"+u).attr("defaultChecked",!0)):(n("#"+o,"#"+u).attr("checked",!1),n("#"+o,"#"+u).attr("defaultChecked",""))):(s=s.toLowerCase(),s.search(/(false|0|no|off|undefined)/i)<0&&s!==""?(n("#"+o,"#"+u).attr("checked",!0),n("#"+o,"#"+u).attr("defaultChecked",!0)):(n("#"+o,"#"+u).attr("checked",!1),n("#"+o,"#"+u).attr("defaultChecked","")));break;case"custom":try{if(c[f].editoptions&&n.isFunction(c[f].editoptions.custom_value))v=c[f].editoptions.custom_value(n("#"+o,"#"+u),"set",s);else throw"e1";}catch(a){a=="e1"?info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+n.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose):info_dialog(jQuery.jgrid.errors.errcap,a.message,jQuery.jgrid.edit.bClose)}}p++}}),p>0&&n("#id_g","#"+f).val(i))}function et(){var b,i=[!0,"",""],k={},l=e.p.prmNames,a,v,y,p,w;n.isFunction(t.beforeCheckValues)&&(y=t.beforeCheckValues(u,n("#"+o),u[e.p.id+"_id"]=="_empty"?l.addoper:l.editoper),y&&typeof y=="object"&&(u=y));for(p in u)if(u.hasOwnProperty(p)&&(i=checkValues(u[p],p,e),i[0]===!1))break;i[0]&&(n.isFunction(t.onclickSubmit)&&(k=t.onclickSubmit(t,u)||{}),n.isFunction(t.beforeSubmit)&&(i=t.beforeSubmit(u,n("#"+o))));i[0]&&!t.processing&&(t.processing=!0,n("#sData","#"+f+"_2").addClass("ui-state-active"),v=l.oper,a=l.id,u[v]=n.trim(u[e.p.id+"_id"])=="_empty"?l.addoper:l.editoper,u[v]!=l.addoper?u[a]=u[e.p.id+"_id"]:u[a]===undefined&&(u[a]=u[e.p.id+"_id"]),delete u[e.p.id+"_id"],u=n.extend(u,t.editData,k),w=n.extend({url:t.url?t.url:n(e).jqGrid("getGridParam","editurl"),type:t.mtype,data:n.isFunction(t.serializeEditData)?t.serializeEditData(u):u,complete:function(y,p){if(p!="success"?(i[0]=!1,i[1]=n.isFunction(t.errorTextFormat)?t.errorTextFormat(y):p+" Status: '"+y.statusText+"'. Error code: "+y.status):n.isFunction(t.afterSubmit)&&(i=t.afterSubmit(y,u)),i[0]===!1?(n("#FormError>td","#"+f).html(i[1]),n("#FormError","#"+f).show()):(n.each(e.p.colModel,function(){if(c[this.name]&&this.formatter&&this.formatter=="select")try{delete c[this.name]}catch(n){}}),u=n.extend(u,c),e.p.autoencode&&n.each(u,function(t,i){u[t]=n.jgrid.htmlDecode(i)}),t.reloadAfterSubmit=t.reloadAfterSubmit&&e.p.datatype!="local",u[v]==l.addoper?(i[2]||(i[2]=parseInt(e.p.records,10)+1+""),u[a]=i[2],t.closeAfterAdd?(t.reloadAfterSubmit?n(e).trigger("reloadGrid"):(n(e).jqGrid("addRowData",i[2],u,r.addedrow),n(e).jqGrid("setSelection",i[2])),hideModal("#"+s.themodal,{gb:"#gbox_"+h,jqm:r.jqModal,onClose:t.onClose})):t.clearAfterAdd?(t.reloadAfterSubmit?n(e).trigger("reloadGrid"):n(e).jqGrid("addRowData",i[2],u,r.addedrow),ft("_empty",e,o)):t.reloadAfterSubmit?n(e).trigger("reloadGrid"):n(e).jqGrid("addRowData",i[2],u,r.addedrow)):(t.reloadAfterSubmit?(n(e).trigger("reloadGrid"),t.closeAfterEdit||setTimeout(function(){n(e).jqGrid("setSelection",u[a])},1e3)):e.p.treeGrid===!0?n(e).jqGrid("setTreeRow",u[a],u):n(e).jqGrid("setRowData",u[a],u),t.closeAfterEdit&&hideModal("#"+s.themodal,{gb:"#gbox_"+h,jqm:r.jqModal,onClose:t.onClose})),n.isFunction(t.afterComplete)&&(b=y,setTimeout(function(){t.afterComplete(b,u,n("#"+o));b=null},500))),t.processing=!1,(t.checkOnSubmit||t.checkOnUpdate)&&(n("#"+o).data("disabled",!1),t._savedData[e.p.id+"_id"]!="_empty"))for(var w in t._savedData)u[w]&&(t._savedData[w]=u[w]);n("#sData","#"+f+"_2").removeClass("ui-state-active");try{n(":input:visible","#"+o)[0].focus()}catch(k){}},error:function(i,r,u){n("#FormError>td","#"+f).html(r+" : "+u);n("#FormError","#"+f).show();t.processing=!1;n("#"+o).data("disabled",!1);n("#sData","#"+f+"_2").removeClass("ui-state-active")}},n.jgrid.ajaxOptions,t.ajaxEditOptions),w.url||t.useDataProxy||(n.isFunction(e.p.dataProxy)?t.useDataProxy=!0:(i[0]=!1,i[1]+=" "+n.jgrid.errors.nourl)),i[0]&&(t.useDataProxy?e.p.dataProxy.call(e,w,"set_"+e.p.id):n.ajax(w)));i[0]===!1&&(n("#FormError>td","#"+f).html(i[1]),n("#FormError","#"+f).show())}function gt(n,t){var i=!1;for(var r in n)if(n[r]!=t[r]){i=!0;break}return i}var e=this,a,rt,ct,lt,kt,ut,at;if(e.grid&&i){var h=e.p.id,o="FrmGrid_"+h,f="TblGrid_"+h,s={themodal:"editmod"+h,modalhead:"edithd"+h,modalcontent:"editcnt"+h,scrollelm:o},w=n.isFunction(t.beforeShowForm)?t.beforeShowForm:!1,b=n.isFunction(t.afterShowForm)?t.afterShowForm:!1,k=n.isFunction(t.beforeInitData)?t.beforeInitData:!1,pt=n.isFunction(t.onInitializeForm)?t.onInitializeForm:!1,p=1,ot=0,u,c,d,g;if(i=="new"?(i="_empty",r.caption=r.addCaption):r.caption=r.editCaption,r.recreateForm===!0&&n("#"+s.themodal).html()!=null&&n("#"+s.themodal).remove(),a=!0,r.checkOnUpdate&&r.jqModal&&!r.modal&&(a=!1),n("#"+s.themodal).html()!=null)n(".ui-jqdialog-title","#"+s.modalhead).html(r.caption),n("#FormError","#"+f).hide(),t.topinfo?(n(".topinfo","#"+f+"_2").html(t.topinfo),n(".tinfo","#"+f+"_2").show()):n(".tinfo","#"+f+"_2").hide(),t.bottominfo?(n(".bottominfo","#"+f+"_2").html(t.bottominfo),n(".binfo","#"+f+"_2").show()):n(".binfo","#"+f+"_2").hide(),k&&k(n("#"+o)),ft(i,e,o),i!="_empty"&&t.viewPagerButtons?n("#pData, #nData","#"+f+"_2").show():n("#pData, #nData","#"+f+"_2").hide(),t.processing===!0&&(t.processing=!1,n("#sData","#"+f+"_2").removeClass("ui-state-active")),n("#"+o).data("disabled")===!0&&(n(".confirm","#"+s.themodal).hide(),n("#"+o).data("disabled",!1)),w&&w(n("#"+o)),n("#"+s.themodal).data("onClose",t.onClose),viewModal("#"+s.themodal,{gbox:"#gbox_"+h,jqm:r.jqModal,jqM:!1,closeoverlay:a,modal:r.modal}),a||n(".jqmOverlay").click(function(){return l()?(hideModal("#"+s.themodal,{gb:"#gbox_"+h,jqm:r.jqModal,onClose:t.onClose}),!1):!1}),b&&b(n("#"+o));else{n(e.p.colModel).each(function(){var n=this.formoptions;p=Math.max(p,n?n.colpos||0:0);ot=Math.max(ot,n?n.rowpos||0:0)});var ni=isNaN(r.dataheight)?r.dataheight:r.dataheight+"px",v,wt=n("<form name='FormPost' id='"+o+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+ni+";'><\/form>").data("disabled",!1),y=n("<table id='"+f+"' class='EditTable' cellspacing='0' cellpading='0' border='0'><tbody><\/tbody><\/table>");n(wt).append(y);v=n("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+p*2+"'><\/td><\/tr>");v[0].rp=0;n(y).append(v);v=n("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+p*2+"'>"+t.topinfo+"<\/td><\/tr>");v[0].rp=0;n(y).append(v);k&&k(n("#"+o));var nt=e.p.direction=="rtl"?!0:!1,ti=nt?"nData":"pData",ii=nt?"pData":"nData",ui=ri(i,e,y,p),bt="<a href='javascript:void(0)' id='"+ti+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'><\/span><\/div>",tt="<a href='javascript:void(0)' id='"+ii+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'><\/span><\/div>",st="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+r.bSubmit+"<\/a>",ht="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+r.bCancel+"<\/a>",it="<table border='0' class='EditTable' id='"+f+"_2'><tbody><tr id='Act_Buttons'><td class='navButton ui-widget-content'>"+(nt?tt+bt:bt+tt)+"<\/td><td class='EditButton ui-widget-content'>"+st+ht+"<\/td><\/tr>";it+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+t.bottominfo+"<\/td><\/tr>";it+="<\/tbody><\/table>";ot>0&&(rt=[],n.each(n(y)[0].rows,function(n,t){rt[n]=t}),rt.sort(function(n,t){return n.rp>t.rp?1:n.rp<t.rp?-1:0}),n.each(rt,function(t,i){n("tbody",y).append(i)}));r.gbox="#gbox_"+h;ct=!1;r.closeOnEscape===!0&&(r.closeOnEscape=!1,ct=!0);lt=n("<span><\/span>").append(wt).append(it);createModal(s,lt,r,"#gview_"+e.p.id,n("#gbox_"+e.p.id)[0]);nt&&(n("#pData, #nData","#"+f+"_2").css("float","right"),n(".EditButton","#"+f+"_2").css("text-align","left"));t.topinfo&&n(".tinfo","#"+f+"_2").show();t.bottominfo&&n(".binfo","#"+f+"_2").show();lt=null;it=null;n("#"+s.themodal).keydown(function(i){var u=i.target;if(n("#"+o).data("disabled")===!0)return!1;if(t.savekey[0]===!0&&i.which==t.savekey[1]&&u.tagName!="TEXTAREA")return n("#sData","#"+f+"_2").trigger("click"),!1;if(i.which===27)return l()?(ct&&hideModal(this,{gb:r.gbox,jqm:r.jqModal,onClose:t.onClose}),!1):!1;if(t.navkeys[0]===!0){if(n("#id_g","#"+f).val()=="_empty")return!0;if(i.which==t.navkeys[1])return n("#pData","#"+f+"_2").trigger("click"),!1;if(i.which==t.navkeys[2])return n("#nData","#"+f+"_2").trigger("click"),!1}});r.checkOnUpdate&&(n("a.ui-jqdialog-titlebar-close span","#"+s.themodal).removeClass("jqmClose"),n("a.ui-jqdialog-titlebar-close","#"+s.themodal).unbind("click").click(function(){return l()?(hideModal("#"+s.themodal,{gb:"#gbox_"+h,jqm:r.jqModal,onClose:t.onClose}),!1):!1}));r.saveicon=n.extend([!0,"left","ui-icon-disk"],r.saveicon);r.closeicon=n.extend([!0,"left","ui-icon-close"],r.closeicon);r.saveicon[0]===!0&&n("#sData","#"+f+"_2").addClass(r.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.saveicon[2]+"'><\/span>");r.closeicon[0]===!0&&n("#cData","#"+f+"_2").addClass(r.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.closeicon[2]+"'><\/span>");(t.checkOnSubmit||t.checkOnUpdate)&&(st="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+r.bYes+"<\/a>",tt="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+r.bNo+"<\/a>",ht="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+r.bExit+"<\/a>",ut=r.zIndex||999,ut++,kt=n.browser.msie&&n.browser.version==6?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"><\/iframe>':"",n("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+ut+";display:none;'>&#160;"+kt+"<\/div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(ut+1)+"'>"+r.saveData+"<br/><br/>"+st+tt+ht+"<\/div>").insertAfter("#"+o),n("#sNew","#"+s.themodal).click(function(){return et(),n("#"+o).data("disabled",!1),n(".confirm","#"+s.themodal).hide(),!1}),n("#nNew","#"+s.themodal).click(function(){return n(".confirm","#"+s.themodal).hide(),n("#"+o).data("disabled",!1),setTimeout(function(){n(":input","#"+o)[0].focus()},0),!1}),n("#cNew","#"+s.themodal).click(function(){return n(".confirm","#"+s.themodal).hide(),n("#"+o).data("disabled",!1),hideModal("#"+s.themodal,{gb:"#gbox_"+h,jqm:r.jqModal,onClose:t.onClose}),!1}));pt&&pt(n("#"+o));i!="_empty"&&t.viewPagerButtons?n("#pData,#nData","#"+f+"_2").show():n("#pData,#nData","#"+f+"_2").hide();w&&w(n("#"+o));n("#"+s.themodal).data("onClose",t.onClose);viewModal("#"+s.themodal,{gbox:"#gbox_"+h,jqm:r.jqModal,closeoverlay:a,modal:r.modal});a||n(".jqmOverlay").click(function(){return l()?(hideModal("#"+s.themodal,{gb:"#gbox_"+h,jqm:r.jqModal,onClose:t.onClose}),!1):!1});b&&b(n("#"+o));n(".fm-button","#"+s.themodal).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")});n("#sData","#"+f+"_2").click(function(){return u={},c={},n("#FormError","#"+f).hide(),dt(),u[e.p.id+"_id"]=="_empty"?et():r.checkOnSubmit===!0?(d=n.extend({},u,c),g=gt(d,t._savedData),g?(n("#"+o).data("disabled",!0),n(".confirm","#"+s.themodal).show()):et()):et(),!1});n("#cData","#"+f+"_2").click(function(){return l()?(hideModal("#"+s.themodal,{gb:"#gbox_"+h,jqm:r.jqModal,onClose:t.onClose}),!1):!1});n("#nData","#"+f+"_2").click(function(){if(!l())return!1;n("#FormError","#"+f).hide();var t=yt();if(t[0]=parseInt(t[0],10),t[0]!=-1&&t[1][t[0]+1]){if(n.isFunction(r.onclickPgButtons))r.onclickPgButtons("next",n("#"+o),t[1][t[0]]);ft(t[1][t[0]+1],e,o);n(e).jqGrid("setSelection",t[1][t[0]+1]);n.isFunction(r.afterclickPgButtons)&&r.afterclickPgButtons("next",n("#"+o),t[1][t[0]+1]);vt(t[0]+1,t[1].length-1)}return!1});n("#pData","#"+f+"_2").click(function(){if(!l())return!1;n("#FormError","#"+f).hide();var t=yt();if(t[0]!=-1&&t[1][t[0]-1]){if(n.isFunction(r.onclickPgButtons))r.onclickPgButtons("prev",n("#"+o),t[1][t[0]]);ft(t[1][t[0]-1],e,o);n(e).jqGrid("setSelection",t[1][t[0]-1]);n.isFunction(r.afterclickPgButtons)&&r.afterclickPgButtons("prev",n("#"+o),t[1][t[0]-1]);vt(t[0]-1,t[1].length-1)}return!1})}at=yt();vt(at[0],at[1].length-1)}})},viewGridRow:function(t,i){return i=n.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:!1,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"30%",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,viewPagerButtons:!0},n.jgrid.view,i||{}),this.each(function(){function l(){(i.closeOnEscape===!0||i.navkeys[0]===!0)&&setTimeout(function(){n(".ui-jqdialog-titlebar-close","#"+o.modalhead).focus()},0)}function b(t,i){t===0?n("#pData","#"+r+"_2").addClass("ui-state-disabled"):n("#pData","#"+r+"_2").removeClass("ui-state-disabled");t==i?n("#nData","#"+r+"_2").addClass("ui-state-disabled"):n("#nData","#"+r+"_2").removeClass("ui-state-disabled")}function k(){var t=n(u).jqGrid("getDataIDs"),i=n("#id_g","#"+r).val(),f=n.inArray(i,t);return[f,t]}function et(t,r,u,f){for(var b,e,s,o,h=0,c,k,d=[],l=!1,tt="<td class='CaptionTD form-view-label ui-widget-content' width='"+i.labelswidth+"'>&#160;<\/td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;<\/td>",g="",it=["integer","number","currency"],a=0,v=0,y,p,nt,w=1;w<=f;w++)g+=w==1?tt:"<td class='CaptionTD form-view-label ui-widget-content'>&#160;<\/td><td class='DataTD form-view-data ui-widget-content'>&#160;<\/td>";return n(r.p.colModel).each(function(){s=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1;s||this.align!=="right"||(this.formatter&&n.inArray(this.formatter,it)!==-1?a=Math.max(a,parseInt(this.width,10)):v=Math.max(v,parseInt(this.width,10)))}),y=a!==0?a:v!==0?v:0,l=n(r).jqGrid("getInd",t),n(r.p.colModel).each(function(t){var w;if(e=this.name,p=!1,s=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1,k=s?"style='display:none'":"",nt=typeof this.viewable!="boolean"?!0:this.viewable,e!=="cb"&&e!=="subgrid"&&e!=="rn"&&nt){c=l===!1?"":e==r.p.ExpandColumn&&r.p.treeGrid===!0?n("td:eq("+t+")",r.rows[l]).text():n("td:eq("+t+")",r.rows[l]).html();p=this.align==="right"&&y!==0?!0:!1;var b=n.extend({},this.editoptions||{},{id:e,name:e}),i=n.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),a=parseInt(i.rowpos,10)||h+1,v=parseInt((parseInt(i.colpos,10)||1)*2,10);i.rowabove&&(w=n("<tr><td class='contentinfo' colspan='"+f*2+"'>"+i.rowcontent+"<\/td><\/tr>"),n(u).append(w),w[0].rp=a);o=n(u).find("tr[rowpos="+a+"]");o.length===0&&(o=n("<tr "+k+" rowpos='"+a+"'><\/tr>").addClass("FormData").attr("id","trv_"+e),n(o).append(g),n(u).append(o),o[0].rp=a);n("td:eq("+(v-2)+")",o[0]).html("<b>"+(typeof i.label=="undefined"?r.p.colNames[t]:i.label)+"<\/b>");n("td:eq("+(v-1)+")",o[0]).append("<span>"+c+"<\/span>").attr("id","v_"+e);p&&n("td:eq("+(v-1)+") span",o[0]).css({"text-align":"right",width:y+"px"});d[h]=t;h++}}),h>0&&(b=n("<tr class='FormData' style='display:none'><td class='CaptionTD'><\/td><td colspan='"+(f*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/><\/td><\/tr>"),b[0].rp=h+99,n(u).append(b)),d}function d(t,i){var u,f,s=0,e,h,o;(o=n(i).jqGrid("getInd",t,!0),o)&&(n("td",o).each(function(t){u=i.p.colModel[t].name;f=i.p.colModel[t].editrules&&i.p.colModel[t].editrules.edithidden===!0?!1:i.p.colModel[t].hidden===!0?!0:!1;u!=="cb"&&u!=="subgrid"&&u!=="rn"&&(e=u==i.p.ExpandColumn&&i.p.treeGrid===!0?n(this).text():n(this).html(),h=n.extend({},i.p.colModel[t].editoptions||{}),u=n.jgrid.jqID("v_"+u),n("#"+u+" span","#"+r).html(e),f&&n("#"+u,"#"+r).parents("tr:first").hide(),s++)}),s>0&&n("#id_g","#"+r).val(t))}var u=this,c,y,p,w;if(u.grid&&t){i.imgpath||(i.imgpath=u.p.imgpath);var f=u.p.id,e="ViewGrid_"+f,r="ViewTbl_"+f,o={themodal:"viewmod"+f,modalhead:"viewhd"+f,modalcontent:"viewcnt"+f,scrollelm:e},a=1,v=0;if(n("#"+o.themodal).html()!=null)n(".ui-jqdialog-title","#"+o.modalhead).html(i.caption),n("#FormError","#"+r).hide(),d(t,u),n.isFunction(i.beforeShowForm)&&i.beforeShowForm(n("#"+e)),viewModal("#"+o.themodal,{gbox:"#gbox_"+f,jqm:i.jqModal,jqM:!1,modal:i.modal}),l();else{n(u.p.colModel).each(function(){var n=this.formoptions;a=Math.max(a,n?n.colpos||0:0);v=Math.max(v,n?n.rowpos||0:0)});var it=isNaN(i.dataheight)?i.dataheight:i.dataheight+"px",g=n("<form name='FormPost' id='"+e+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+it+";'><\/form>"),s=n("<table id='"+r+"' class='EditTable' cellspacing='1' cellpading='2' border='0' style='table-layout:fixed'><tbody><\/tbody><\/table>");n(g).append(s);var ot=et(t,u,s,a),h=u.p.direction=="rtl"?!0:!1,rt=h?"nData":"pData",ut=h?"pData":"nData",nt="<a href='javascript:void(0)' id='"+rt+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'><\/span><\/div>",tt="<a href='javascript:void(0)' id='"+ut+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'><\/span><\/div>",ft="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+i.bClose+"<\/a>";v>0&&(c=[],n.each(n(s)[0].rows,function(n,t){c[n]=t}),c.sort(function(n,t){return n.rp>t.rp?1:n.rp<t.rp?-1:0}),n.each(c,function(t,i){n("tbody",s).append(i)}));i.gbox="#gbox_"+f;y=!1;i.closeOnEscape===!0&&(i.closeOnEscape=!1,y=!0);p=n("<span><\/span>").append(g).append("<table border='0' class='EditTable' id='"+r+"_2'><tbody><tr id='Act_Buttons'><td class='navButton ui-widget-content' width='"+i.labelswidth+"'>"+(h?tt+nt:nt+tt)+"<\/td><td class='EditButton ui-widget-content'>"+ft+"<\/td><\/tr><\/tbody><\/table>");createModal(o,p,i,"#gview_"+u.p.id,n("#gview_"+u.p.id)[0]);h&&(n("#pData, #nData","#"+r+"_2").css("float","right"),n(".EditButton","#"+r+"_2").css("text-align","left"));i.viewPagerButtons||n("#pData, #nData","#"+r+"_2").hide();p=null;n("#"+o.themodal).keydown(function(t){if(t.which===27)return y&&hideModal(this,{gb:i.gbox,jqm:i.jqModal,onClose:i.onClose}),!1;if(i.navkeys[0]===!0){if(t.which===i.navkeys[1])return n("#pData","#"+r+"_2").trigger("click"),!1;if(t.which===i.navkeys[2])return n("#nData","#"+r+"_2").trigger("click"),!1}});i.closeicon=n.extend([!0,"left","ui-icon-close"],i.closeicon);i.closeicon[0]===!0&&n("#cData","#"+r+"_2").addClass(i.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+i.closeicon[2]+"'><\/span>");n.isFunction(i.beforeShowForm)&&i.beforeShowForm(n("#"+e));viewModal("#"+o.themodal,{gbox:"#gbox_"+f,jqm:i.jqModal,modal:i.modal});n(".fm-button:not(.ui-state-disabled)","#"+r+"_2").hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")});l();n("#cData","#"+r+"_2").click(function(){return hideModal("#"+o.themodal,{gb:"#gbox_"+f,jqm:i.jqModal,onClose:i.onClose}),!1});n("#nData","#"+r+"_2").click(function(){n("#FormError","#"+r).hide();var t=k();if(t[0]=parseInt(t[0],10),t[0]!=-1&&t[1][t[0]+1]){if(n.isFunction(i.onclickPgButtons))i.onclickPgButtons("next",n("#"+e),t[1][t[0]]);d(t[1][t[0]+1],u);n(u).jqGrid("setSelection",t[1][t[0]+1]);n.isFunction(i.afterclickPgButtons)&&i.afterclickPgButtons("next",n("#"+e),t[1][t[0]+1]);b(t[0]+1,t[1].length-1)}return l(),!1});n("#pData","#"+r+"_2").click(function(){n("#FormError","#"+r).hide();var t=k();if(t[0]!=-1&&t[1][t[0]-1]){if(n.isFunction(i.onclickPgButtons))i.onclickPgButtons("prev",n("#"+e),t[1][t[0]]);d(t[1][t[0]-1],u);n(u).jqGrid("setSelection",t[1][t[0]-1]);n.isFunction(i.afterclickPgButtons)&&i.afterclickPgButtons("prev",n("#"+e),t[1][t[0]-1]);b(t[0]-1,t[1].length-1)}return l(),!1})}w=k();b(w[0],w[1].length-1)}})},delGridRow:function(i,r){return r=n.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},n.jgrid.del,r||{}),t=r,this.each(function(){var f=this,w,o,b,k;if(f.grid&&i){var a=typeof r.beforeShowForm=="function"?!0:!1,v=typeof r.afterShowForm=="function"?!0:!1,e=f.p.id,l={},u="DelTbl_"+e,h,y,c,p,s={themodal:"delmod"+e,modalhead:"delhd"+e,modalcontent:"delcnt"+e,scrollelm:u};jQuery.isArray(i)&&(i=i.join());n("#"+s.themodal).html()!=null?(n("#DelData>td","#"+u).text(i),n("#DelError","#"+u).hide(),t.processing===!0&&(t.processing=!1,n("#dData","#"+u).removeClass("ui-state-active")),a&&r.beforeShowForm(n("#"+u)),viewModal("#"+s.themodal,{gbox:"#gbox_"+e,jqm:r.jqModal,jqM:!1,modal:r.modal}),v&&r.afterShowForm(n("#"+u))):(w=isNaN(r.dataheight)?r.dataheight:r.dataheight+"px",o="<div id='"+u+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+w+";'>",o+="<table class='DelTable'><tbody>",o+="<tr id='DelError' style='display:none'><td class='ui-state-error'><\/td><\/tr>",o+="<tr id='DelData' style='display:none'><td >"+i+"<\/td><\/tr>",o+='<tr><td class="delmsg" style="white-space:pre;">'+r.msg+"<\/td><\/tr><tr><td >&#160;<\/td><\/tr>",o+="<\/tbody><\/table><\/div>",b="<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+r.bSubmit+"<\/a>",k="<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+r.bCancel+"<\/a>",o+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+u+"_2'><tbody><tr><td class='DataTD ui-widget-content'><\/td><\/tr><tr style='display:block;height:3px;'><td><\/td><\/tr><tr><td class='DelButton EditButton'>"+b+"&#160;"+k+"<\/td><\/tr><\/tbody><\/table>",r.gbox="#gbox_"+e,createModal(s,o,r,"#gview_"+f.p.id,n("#gview_"+f.p.id)[0]),n(".fm-button","#"+u+"_2").hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")}),r.delicon=n.extend([!0,"left","ui-icon-scissors"],r.delicon),r.cancelicon=n.extend([!0,"left","ui-icon-cancel"],r.cancelicon),r.delicon[0]===!0&&n("#dData","#"+u+"_2").addClass(r.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.delicon[2]+"'><\/span>"),r.cancelicon[0]===!0&&n("#eData","#"+u+"_2").addClass(r.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.cancelicon[2]+"'><\/span>"),n("#dData","#"+u+"_2").click(function(){var i=[!0,""],o,a;return l={},o=n("#DelData>td","#"+u).text(),typeof r.onclickSubmit=="function"&&(l=r.onclickSubmit(t,o)||{}),typeof r.beforeSubmit=="function"&&(i=r.beforeSubmit(o)),i[0]&&!t.processing&&(t.processing=!0,n(this).addClass("ui-state-active"),c=f.p.prmNames,h=n.extend({},t.delData,l),p=c.oper,h[p]=c.deloper,y=c.id,h[y]=o,a=n.extend({url:t.url?t.url:n(f).jqGrid("getGridParam","editurl"),type:r.mtype,data:n.isFunction(r.serializeDelData)?r.serializeDelData(h):h,complete:function(c,l){var a,v;if(l!="success"?(i[0]=!1,i[1]=n.isFunction(t.errorTextFormat)?t.errorTextFormat(c):l+" Status: '"+c.statusText+"'. Error code: "+c.status):typeof t.afterSubmit=="function"&&(i=t.afterSubmit(c,h)),i[0]===!1)n("#DelError>td","#"+u).html(i[1]),n("#DelError","#"+u).show();else{if(t.reloadAfterSubmit&&f.p.datatype!="local")n(f).trigger("reloadGrid");else{if(a=[],a=o.split(","),f.p.treeGrid===!0)try{n(f).jqGrid("delTreeNode",a[0])}catch(y){}else for(v=0;v<a.length;v++)n(f).jqGrid("delRowData",a[v]);f.p.selrow=null;f.p.selarrrow=[]}n.isFunction(t.afterComplete)&&setTimeout(function(){t.afterComplete(c,o)},500)}t.processing=!1;n("#dData","#"+u+"_2").removeClass("ui-state-active");i[0]&&hideModal("#"+s.themodal,{gb:"#gbox_"+e,jqm:r.jqModal,onClose:t.onClose})},error:function(i,r,f){n("#DelError>td","#"+u).html(r+" : "+f);n("#DelError","#"+u).show();t.processing=!1;n("#dData","#"+u+"_2").removeClass("ui-state-active")}},n.jgrid.ajaxOptions,r.ajaxDelOptions),a.url||t.useDataProxy||(n.isFunction(f.p.dataProxy)?t.useDataProxy=!0:(i[0]=!1,i[1]+=" "+n.jgrid.errors.nourl)),i[0]&&(t.useDataProxy?f.p.dataProxy.call(f,a,"del_"+f.p.id):n.ajax(a))),i[0]===!1&&(n("#DelError>td","#"+u).html(i[1]),n("#DelError","#"+u).show()),!1}),n("#eData","#"+u+"_2").click(function(){return hideModal("#"+s.themodal,{gb:"#gbox_"+e,jqm:r.jqModal,onClose:t.onClose}),!1}),a&&r.beforeShowForm(n("#"+u)),viewModal("#"+s.themodal,{gbox:"#gbox_"+e,jqm:r.jqModal,modal:r.modal}),v&&r.afterShowForm(n("#"+u)));r.closeOnEscape===!0&&setTimeout(function(){n(".ui-jqdialog-titlebar-close","#"+s.modalhead).focus()},0)}})},navGrid:function(t,i,r,u,f,e,o){return i=n.extend({edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",del:!0,delicon:"ui-icon-trash",search:!0,searchicon:"ui-icon-search",refresh:!0,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:!1,viewicon:"ui-icon-document",position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1},n.jgrid.nav,i||{}),this.each(function(){var y={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},s=this,p,w,v,d,b,k,h,c,g,a,l;if(s.grid&&typeof t=="string")for(n("#"+y.themodal).html()===null&&(typeof innerWidth!="undefined"?(p=window.innerWidth,w=window.innerHeight):typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0?(p=document.documentElement.clientWidth,w=document.documentElement.clientHeight):(p=1024,w=768),createModal(y,"<div>"+i.alerttext+"<\/div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'><\/span><\/span>",{gbox:"#gbox_"+s.p.id,jqModal:!0,drag:!0,resize:!0,caption:i.alertcap,top:w/2-25,left:p/2-100,width:200,height:"auto",closeOnEscape:i.closeOnEscape},"","",!0)),b=1,i.cloneToTop&&s.p.toppager&&(b=2),k=0;k<b;k++)c=n("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr><\/tr><\/tbody><\/table>"),g="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'><\/span><\/td>",k===0?(a=t,l=s.p.id,a==s.p.toppager&&(l+="_top",b=1)):(a=s.p.toppager,l=s.p.id+"_top"),s.p.direction=="rtl"&&n(c).attr("dir","rtl").css("float","right"),i.add&&(u=u||{},h=n("<td class='ui-pg-button ui-corner-all'><\/td>"),n(h).append("<div class='ui-pg-div'><span class='ui-icon "+i.addicon+"'><\/span>"+i.addtext+"<\/div>"),n("tr",c).append(h),n(h,c).attr({title:i.addtitle||"",id:u.id||"add_"+l}).click(function(){return n(this).hasClass("ui-state-disabled")||(typeof i.addfunc=="function"?i.addfunc():n(s).jqGrid("editGridRow","new",u)),!1}).hover(function(){n(this).hasClass("ui-state-disabled")||n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")}),h=null),i.edit&&(h=n("<td class='ui-pg-button ui-corner-all'><\/td>"),r=r||{},n(h).append("<div class='ui-pg-div'><span class='ui-icon "+i.editicon+"'><\/span>"+i.edittext+"<\/div>"),n("tr",c).append(h),n(h,c).attr({title:i.edittitle||"",id:r.id||"edit_"+l}).click(function(){if(!n(this).hasClass("ui-state-disabled")){var t=s.p.selrow;t?typeof i.editfunc=="function"?i.editfunc(t):n(s).jqGrid("editGridRow",t,r):(viewModal("#"+y.themodal,{gbox:"#gbox_"+s.p.id,jqm:!0}),n("#jqg_alrt").focus())}return!1}).hover(function(){n(this).hasClass("ui-state-disabled")||n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")}),h=null),i.view&&(h=n("<td class='ui-pg-button ui-corner-all'><\/td>"),o=o||{},n(h).append("<div class='ui-pg-div'><span class='ui-icon "+i.viewicon+"'><\/span>"+i.viewtext+"<\/div>"),n("tr",c).append(h),n(h,c).attr({title:i.viewtitle||"",id:o.id||"view_"+l}).click(function(){if(!n(this).hasClass("ui-state-disabled")){var t=s.p.selrow;t?n(s).jqGrid("viewGridRow",t,o):(viewModal("#"+y.themodal,{gbox:"#gbox_"+s.p.id,jqm:!0}),n("#jqg_alrt").focus())}return!1}).hover(function(){n(this).hasClass("ui-state-disabled")||n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")}),h=null),i.del&&(h=n("<td class='ui-pg-button ui-corner-all'><\/td>"),f=f||{},n(h).append("<div class='ui-pg-div'><span class='ui-icon "+i.delicon+"'><\/span>"+i.deltext+"<\/div>"),n("tr",c).append(h),n(h,c).attr({title:i.deltitle||"",id:f.id||"del_"+l}).click(function(){if(!n(this).hasClass("ui-state-disabled")){var t;s.p.multiselect?(t=s.p.selarrrow,t.length===0&&(t=null)):t=s.p.selrow;t?"function"==typeof i.delfunc?i.delfunc(t):n(s).jqGrid("delGridRow",t,f):(viewModal("#"+y.themodal,{gbox:"#gbox_"+s.p.id,jqm:!0}),n("#jqg_alrt").focus())}return!1}).hover(function(){n(this).hasClass("ui-state-disabled")||n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")}),h=null),(i.add||i.edit||i.del||i.view)&&n("tr",c).append(g),i.search&&(h=n("<td class='ui-pg-button ui-corner-all'><\/td>"),e=e||{},n(h).append("<div class='ui-pg-div'><span class='ui-icon "+i.searchicon+"'><\/span>"+i.searchtext+"<\/div>"),n("tr",c).append(h),n(h,c).attr({title:i.searchtitle||"",id:e.id||"search_"+l}).click(function(){return n(this).hasClass("ui-state-disabled")||n(s).jqGrid("searchGrid",e),!1}).hover(function(){n(this).hasClass("ui-state-disabled")||n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")}),h=null),i.refresh&&(h=n("<td class='ui-pg-button ui-corner-all'><\/td>"),n(h).append("<div class='ui-pg-div'><span class='ui-icon "+i.refreshicon+"'><\/span>"+i.refreshtext+"<\/div>"),n("tr",c).append(h),n(h,c).attr({title:i.refreshtitle||"",id:"refresh_"+l}).click(function(){if(!n(this).hasClass("ui-state-disabled")){n.isFunction(i.beforeRefresh)&&i.beforeRefresh();s.p.search=!1;try{var t=s.p.id;n("#fbox_"+t).searchFilter().reset({reload:!1});n.isFunction(s.clearToolbar)&&s.clearToolbar(!1)}catch(r){}switch(i.refreshstate){case"firstpage":n(s).trigger("reloadGrid",[{page:1}]);break;case"current":n(s).trigger("reloadGrid",[{current:!0}])}n.isFunction(i.afterRefresh)&&i.afterRefresh()}return!1}).hover(function(){n(this).hasClass("ui-state-disabled")||n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")}),h=null),d=n(".ui-jqgrid").css("font-size")||"11px",n("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+d+";visibility:hidden;' ><\/div>"),v=n(c).clone().appendTo("#testpg2").width(),n("#testpg2").remove(),n(a+"_"+i.position,a).append(c),s.p._nvtd&&(v>s.p._nvtd[0]&&(n(a+"_"+i.position,a).width(v),s.p._nvtd[0]=v),s.p._nvtd[1]=v),d=null,v=null,c=null})},navButtonAdd:function(t,i){return i=n.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},i||{}),this.each(function(){var u,f,r;this.grid&&(t.indexOf("#")!==0&&(t="#"+t),u=n(".navtable",t)[0],f=this,u&&(r=n("<td><\/td>"),i.buttonicon.toString().toUpperCase()=="NONE"?n(r).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+i.caption+"<\/div>"):n(r).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+i.buttonicon+"'><\/span>"+i.caption+"<\/div>"),i.id&&n(r).attr("id",i.id),i.position=="first"?u.rows[0].cells.length===0?n("tr",u).append(r):n("tr td:eq(0)",u).before(r):n("tr",u).append(r),n(r,u).attr("title",i.title||"").click(function(t){return n(this).hasClass("ui-state-disabled")||n.isFunction(i.onClickButton)&&i.onClickButton.call(f,t),!1}).hover(function(){n(this).hasClass("ui-state-disabled")||n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})))})},navSeparatorAdd:function(t,i){return i=n.extend({sepclass:"ui-separator",sepcontent:""},i||{}),this.each(function(){var r,u;this.grid&&(t.indexOf("#")!==0&&(t="#"+t),r=n(".navtable",t)[0],r&&(u="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+i.sepclass+"'><\/span>"+i.sepcontent+"<\/td>",n("tr",r).append(u)))})},GridToForm:function(t,i){return this.each(function(){var f=this,u,r;if(f.grid&&(u=n(f).jqGrid("getRowData",t),u))for(r in u)n("[name="+r+"]",i).is("input:radio")||n("[name="+r+"]",i).is("input:checkbox")?n("[name="+r+"]",i).each(function(){n(this).val()==u[r]?n(this).attr("checked","checked"):n(this).attr("checked","")}):n("[name="+r+"]",i).val(u[r])})},FormToGrid:function(t,i,r,u){return this.each(function(){var e=this,o,f;e.grid&&(r||(r="set"),u||(u="first"),o=n(i).serializeArray(),f={},n.each(o,function(n,t){f[t.name]=t.value}),r=="add"?n(e).jqGrid("addRowData",t,f,u):r=="set"&&n(e).jqGrid("setRowData",t,f))})}})})(jQuery)