Ext.data.Connection=function(n){Ext.apply(this,n);this.addEvents("beforerequest","requestcomplete","requestexception");Ext.data.Connection.superclass.constructor.call(this)};Ext.extend(Ext.data.Connection,Ext.util.Observable,{timeout:3e4,autoAbort:!1,disableCaching:!0,request:function(n){var t,e,i,r,o,s,u,h,f;if(this.fireEvent("beforerequest",this,n)!==!1){if(t=n.params,typeof t=="function"&&(t=t.call(n.scope||window,n)),typeof t=="object"&&(t=Ext.urlEncode(t)),this.extraParams&&(e=Ext.urlEncode(this.extraParams),t=t?t+"&"+e:e),i=n.url||this.url,typeof i=="function"&&(i=i.call(n.scope||window,n)),n.form){if(r=Ext.getDom(n.form),i=i||r.action,o=r.getAttribute("enctype"),n.isUpload||o&&o.toLowerCase()=="multipart/form-data")return this.doFormUpload(n,t,i);s=Ext.lib.Ajax.serializeForm(r);t=t?t+"&"+s:s}return u=n.headers,this.defaultHeaders&&(u=Ext.apply(u||{},this.defaultHeaders),n.headers||(n.headers=u)),h={success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{options:n},timeout:n.timeout||this.timeout},f=n.method||this.method||(t?"POST":"GET"),(f=="GET"&&this.disableCaching&&n.disableCaching!==!1||n.disableCaching===!0)&&(i+=(i.indexOf("?")!=-1?"&":"?")+"_dc="+(new Date).getTime()),typeof n.autoAbort=="boolean"?n.autoAbort&&this.abort():this.autoAbort!==!1&&this.abort(),(f=="GET"&&t||n.xmlData||n.jsonData)&&(i+=(i.indexOf("?")!=-1?"&":"?")+t,t=""),this.transId=Ext.lib.Ajax.request(f,i,h,t,n),this.transId}return Ext.callback(n.callback,n.scope,[n,null,null]),null},isLoading:function(n){return n?Ext.lib.Ajax.isCallInProgress(n):this.transId?!0:!1},abort:function(n){(n||this.isLoading())&&Ext.lib.Ajax.abort(n||this.transId)},handleResponse:function(n){this.transId=!1;var t=n.argument.options;n.argument=t?t.argument:null;this.fireEvent("requestcomplete",this,n,t);Ext.callback(t.success,t.scope,[n,t]);Ext.callback(t.callback,t.scope,[t,!0,n])},handleFailure:function(n,t){this.transId=!1;var i=n.argument.options;n.argument=i?i.argument:null;this.fireEvent("requestexception",this,n,i,t);Ext.callback(i.failure,i.scope,[n,i]);Ext.callback(i.callback,i.scope,[i,!1,n])},doFormUpload:function(n,t,i){function c(){var i={responseText:"",responseXML:null},t;i.argument=n?n.argument:null;try{t=Ext.isIE?r.contentWindow.document:r.contentDocument||window.frames[f].document;t&&t.body&&(i.responseText=t.body.innerHTML);i.responseXML=t&&t.XMLDocument?t.XMLDocument:t}catch(u){}Ext.EventManager.removeListener(r,"load",c,this);this.fireEvent("requestcomplete",this,i,n);Ext.callback(n.success,n.scope,[i,n]);Ext.callback(n.callback,n.scope,[n,!0,i]);setTimeout(function(){Ext.removeNode(r)},100)}var f=Ext.id(),r=document.createElement("iframe"),u,o,e,s,h,l;if(r.id=f,r.name=f,r.className="x-hidden",Ext.isIE&&(r.src=Ext.SSL_SECURE_URL),document.body.appendChild(r),Ext.isIE&&(document.frames[f].name=f),u=Ext.getDom(n.form),u.target=f,u.method="POST",u.enctype=u.encoding="multipart/form-data",i&&(u.action=i),t){o=[];t=Ext.urlDecode(t,!1);for(s in t)t.hasOwnProperty(s)&&(e=document.createElement("input"),e.type="hidden",e.name=s,e.value=t[s],u.appendChild(e),o.push(e))}Ext.EventManager.on(r,"load",c,this);if(u.submit(),o)for(h=0,l=o.length;h<l;h++)Ext.removeNode(o[h])}});Ext.Ajax=new Ext.data.Connection({autoAbort:!1,serializeForm:function(n){return Ext.lib.Ajax.serializeForm(n)}})