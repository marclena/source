Ext.LayoutRegion=function(n,t,i){Ext.LayoutRegion.superclass.constructor.call(this,n,t,i,!0);var r=Ext.DomHelper;this.el=r.append(n.el.dom,{tag:"div",cls:"x-layout-panel x-layout-panel-"+this.position},!0);this.titleEl=r.append(this.el.dom,{tag:"div",unselectable:"on",cls:"x-unselectable x-layout-panel-hd x-layout-title-"+this.position,children:[{tag:"span",cls:"x-unselectable x-layout-panel-hd-text",unselectable:"on",html:"&#160;"},{tag:"div",cls:"x-unselectable x-layout-panel-hd-tools",unselectable:"on"}]},!0);this.titleEl.enableDisplayMode();this.titleTextEl=this.titleEl.dom.firstChild;this.tools=Ext.get(this.titleEl.dom.childNodes[1],!0);this.closeBtn=this.createTool(this.tools.dom,"x-layout-close");this.closeBtn.enableDisplayMode();this.closeBtn.on("click",this.closeClicked,this);if(this.closeBtn.hide(),this.createBody(t),this.visible=!0,this.collapsed=!1,t.hideWhenEmpty){this.hide();this.on("paneladded",this.validateVisibility,this);this.on("panelremoved",this.validateVisibility,this)}this.applyConfig(t)};Ext.extend(Ext.LayoutRegion,Ext.BasicLayoutRegion,{createBody:function(){this.bodyEl=this.el.createChild({tag:"div",cls:"x-layout-panel-body"})},applyConfig:function(n){if(n.collapsible&&this.position!="center"&&!this.collapsedEl){var t=Ext.DomHelper;if(n.titlebar!==!1){this.collapseBtn=this.createTool(this.tools.dom,"x-layout-collapse-"+this.position);this.collapseBtn.on("click",this.collapse,this);if(this.collapseBtn.enableDisplayMode(),n.showPin===!0||this.showPin){this.stickBtn=this.createTool(this.tools.dom,"x-layout-stick");this.stickBtn.enableDisplayMode();this.stickBtn.on("click",this.expand,this);this.stickBtn.hide()}}if(this.collapsedEl=t.append(this.mgr.el.dom,{cls:"x-layout-collapsed x-layout-collapsed-"+this.position,children:[{cls:"x-layout-collapsed-tools",children:[{cls:"x-layout-ctools-inner"}]}]},!0),n.floatable!==!1){this.collapsedEl.addClassOnOver("x-layout-collapsed-over");this.collapsedEl.on("click",this.collapseClick,this)}n.collapsedTitle&&(this.position=="north"||this.position=="south")&&(this.collapsedTitleTextEl=t.append(this.collapsedEl.dom,{tag:"div",cls:"x-unselectable x-layout-panel-hd-text",id:"message",unselectable:"on",style:{float:"left"}}),this.collapsedTitleTextEl.innerHTML=n.collapsedTitle);this.expandBtn=this.createTool(this.collapsedEl.dom.firstChild.firstChild,"x-layout-expand-"+this.position);this.expandBtn.on("click",this.expand,this)}this.collapseBtn&&this.collapseBtn.setVisible(n.collapsible==!0);this.cmargins=n.cmargins||this.cmargins||(this.position=="west"||this.position=="east"?{top:0,left:2,right:2,bottom:0}:{top:2,left:0,right:0,bottom:2});this.margins=n.margins||this.margins||{top:0,left:0,right:0,bottom:0};this.bottomTabs=n.tabPosition!="top";this.autoScroll=n.autoScroll||!1;this.autoScroll?this.bodyEl.setStyle("overflow","auto"):this.bodyEl.setStyle("overflow","hidden");(n.titlebar||n.title)&&n.titlebar!==!1?(this.titleEl.show(),n.title&&(this.titleTextEl.innerHTML=n.title)):this.titleEl.hide();this.duration=n.duration||.3;this.slideDuration=n.slideDuration||.45;this.config=n;n.collapsed&&this.collapse(!0);n.hidden&&this.hide()},isVisible:function(){return this.visible},setCollapsedTitle:function(n){n=n||"&#160;";this.collapsedTitleTextEl&&(this.collapsedTitleTextEl.innerHTML=n)},getBox:function(){return this.collapsed?this.collapsedEl.getBox(!1,!0):this.el.getBox(!1,!0)},getMargins:function(){return this.collapsed?this.cmargins:this.margins},highlight:function(){this.el.addClass("x-layout-panel-dragover")},unhighlight:function(){this.el.removeClass("x-layout-panel-dragover")},updateBox:function(n){this.box=n;this.collapsed?(this.collapsedEl.dom.style.left=n.x+"px",this.collapsedEl.dom.style.top=n.y+"px",this.collapsedEl.setSize(n.width,n.height)):(this.el.dom.style.left=n.x+"px",this.el.dom.style.top=n.y+"px",this.updateBody(n.width,n.height));this.tabs&&this.tabs.autoSizeTabs()},updateBody:function(n,t){if(n!==null&&(this.el.setWidth(n),n-=this.el.getBorderWidth("rl"),this.config.adjustments&&(n+=this.config.adjustments[0])),t!==null&&(this.el.setHeight(t),t=this.titleEl&&this.titleEl.isDisplayed()?t-(this.titleEl.getHeight()||0):t,t-=this.el.getBorderWidth("tb"),this.config.adjustments&&(t+=this.config.adjustments[1]),this.bodyEl.setHeight(t),this.tabs&&(t=this.tabs.syncHeight(t))),this.panelSize&&(n=n!==null?n:this.panelSize.width,t=t!==null?t:this.panelSize.height),this.activePanel){var i=this.activePanel.getEl();n=n!==null?n:i.getWidth();t=t!==null?t:i.getHeight();this.panelSize={width:n,height:t};this.activePanel.setSize(n,t)}Ext.isIE&&this.tabs&&this.tabs.el.repaint()},getEl:function(){return this.el},hide:function(){this.collapsed?(this.collapsedEl.dom.style.left="-2000px",this.collapsedEl.hide()):(this.el.dom.style.left="-2000px",this.el.hide());this.visible=!1;this.fireEvent("visibilitychange",this,!1)},show:function(){this.collapsed?this.collapsedEl.show():this.el.show();this.visible=!0;this.fireEvent("visibilitychange",this,!0)},closeClicked:function(){this.activePanel&&this.remove(this.activePanel)},collapseClick:function(n){this.isSlid?(n.stopPropagation(),this.slideIn()):(n.stopPropagation(),this.slideOut())},collapse:function(n){this.collapsed||(this.collapsed=!0,this.split&&this.split.el.hide(),this.config.animate&&n!==!0?(this.fireEvent("invalidated",this),this.animateCollapse()):(this.el.setLocation(-2e4,-2e4),this.el.hide(),this.collapsedEl.show(),this.fireEvent("collapsed",this),this.fireEvent("invalidated",this)))},animateCollapse:function(){},expand:function(n,t){(n&&n.stopPropagation(),this.collapsed&&!this.el.hasActiveFx())&&(this.isSlid&&(this.afterSlideIn(),t=!0),this.collapsed=!1,this.config.animate&&t!==!0?this.animateExpand():(this.el.show(),this.split&&this.split.el.show(),this.collapsedEl.setLocation(-2e3,-2e3),this.collapsedEl.hide(),this.fireEvent("invalidated",this),this.fireEvent("expanded",this)))},animateExpand:function(){},initTabs:function(){this.bodyEl.setStyle("overflow","hidden");var n=new Ext.TabPanel(this.bodyEl.dom,{tabPosition:this.bottomTabs?"bottom":"top",disableTooltips:this.config.disableTabTips});this.config.hideTabs&&n.stripWrap.setDisplayed(!1);this.tabs=n;n.resizeTabs=this.config.resizeTabs===!0;n.minTabWidth=this.config.minTabWidth||40;n.maxTabWidth=this.config.maxTabWidth||250;n.preferredTabWidth=this.config.preferredTabWidth||150;n.monitorResize=!1;n.bodyEl.setStyle("overflow",this.config.autoScroll?"auto":"hidden");n.bodyEl.addClass("x-layout-tabs-body");this.panels.each(this.initPanelAsTab,this)},initPanelAsTab:function(n){var t=this.tabs.addTab(n.getEl().id,n.getTitle(),null,this.config.closeOnTab&&n.isClosable());n.tabTip!==undefined&&t.setTooltip(n.tabTip);t.on("activate",function(){this.setActivePanel(n)},this);if(this.config.closeOnTab)t.on("beforeclose",function(t,i){i.cancel=!0;this.remove(n)},this);return t},updatePanelTitle:function(n,t){if(this.activePanel==n&&this.updateTitle(t),this.tabs){var i=this.tabs.getTab(n.getEl().id);i.setText(t);n.tabTip!==undefined&&i.setTooltip(n.tabTip)}},updateTitle:function(n){this.titleTextEl&&!this.config.title&&(this.titleTextEl.innerHTML=typeof n!="undefined"&&n.length>0?n:"&#160;")},setActivePanel:function(n){n=this.getPanel(n);this.activePanel&&this.activePanel!=n&&this.activePanel.setActiveState(!1);this.activePanel=n;n.setActiveState(!0);this.panelSize&&n.setSize(this.panelSize.width,this.panelSize.height);this.closeBtn&&this.closeBtn.setVisible(!this.config.closeOnTab&&!this.isSlid&&n.isClosable());this.updateTitle(n.getTitle());this.tabs&&this.fireEvent("invalidated",this);this.fireEvent("panelactivated",this,n)},showPanel:function(n){if(n=this.getPanel(n))if(this.tabs){var t=this.tabs.getTab(n.getEl().id);t.isHidden()&&this.tabs.unhideTab(t.id);t.activate()}else this.setActivePanel(n);return n},getActivePanel:function(){return this.activePanel},validateVisibility:function(){this.panels.getCount()<1?(this.updateTitle("&#160;"),this.closeBtn.hide(),this.hide()):this.isVisible()||this.show()},add:function(n){if(arguments.length>1){for(var t=0,i=arguments.length;t<i;t++)this.add(arguments[t]);return null}return this.hasPanel(n)?(this.showPanel(n),n):(n.setRegion(this),this.panels.add(n),this.panels.getCount()==1&&!this.config.alwaysShowTabs)?(this.bodyEl.dom.appendChild(n.getEl().dom),n.background!==!0&&this.setActivePanel(n),this.fireEvent("paneladded",this,n),n):(this.tabs?this.initPanelAsTab(n):this.initTabs(),n.background!==!0&&this.tabs.activate(n.getEl().id),this.fireEvent("paneladded",this,n),n)},hidePanel:function(n){this.tabs&&(n=this.getPanel(n))&&this.tabs.hideTab(n.getEl().id)},unhidePanel:function(n){this.tabs&&(n=this.getPanel(n))&&this.tabs.unhideTab(n.getEl().id)},clearPanels:function(){while(this.panels.getCount()>0)this.remove(this.panels.first())},remove:function(n,t){var r,f,i,u;if((n=this.getPanel(n),!n)||(r={},this.fireEvent("beforeremove",this,n,r),r.cancel===!0))return null;if(t=typeof t!="undefined"?t:this.config.preservePanels===!0||n.preserve===!0,f=n.getId(),this.panels.removeKey(f),t&&document.body.appendChild(n.getEl().dom),this.tabs?this.tabs.removeTab(n.getEl().id):t||this.bodyEl.dom.removeChild(n.getEl().dom),this.panels.getCount()==1&&this.tabs&&!this.config.alwaysShowTabs&&(i=this.panels.first(),u=document.createElement("div"),u.appendChild(i.getEl().dom),this.bodyEl.update(""),this.bodyEl.dom.appendChild(i.getEl().dom),u=null,this.updateTitle(i.getTitle()),this.tabs=null,this.bodyEl.setStyle("overflow",this.config.autoScroll?"auto":"hidden"),this.setActivePanel(i)),n.setRegion(null),this.activePanel==n&&(this.activePanel=null),this.config.autoDestroy!==!1&&t!==!0)try{n.destroy()}catch(r){}return this.fireEvent("panelremoved",this,n),n},getTabs:function(){return this.tabs},createTool:function(n,t){var i=Ext.DomHelper.append(n,{tag:"div",cls:"x-layout-tools-button",children:[{tag:"div",cls:"x-layout-tools-button-inner "+t,html:"&#160;"}]},!0);return i.addClassOnOver("x-layout-tools-button-over"),i}})