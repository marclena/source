String.prototype.parseColor=function(){var t="#",i,n;if(this.slice(0,4)=="rgb("){i=this.slice(4,this.length-1).split(",");n=0;do t+=parseInt(i[n]).toColorPart();while(++n<3)}else if(this.slice(0,1)=="#"){if(this.length==4)for(n=1;n<4;n++)t+=(this.charAt(n)+this.charAt(n)).toLowerCase();this.length==7&&(t=this.toLowerCase())}return t.length==7?t:arguments[0]||this};Element.collectTextNodes=function(n){return $A($(n).childNodes).collect(function(n){return n.nodeType==3?n.nodeValue:n.hasChildNodes()?Element.collectTextNodes(n):""}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(n,t){return $A($(n).childNodes).collect(function(n){return n.nodeType==3?n.nodeValue:n.hasChildNodes()&&!Element.hasClassName(n,t)?Element.collectTextNodesIgnoreClass(n,t):""}).flatten().join("")};Element.setContentZoom=function(n,t){return n=$(n),n.setStyle({fontSize:t/100+"em"}),navigator.appVersion.indexOf("AppleWebKit")>0&&window.scrollBy(0,0),n};Element.getOpacity=function(n){return $(n).getStyle("opacity")};Element.setOpacity=function(n,t){return $(n).setStyle({opacity:t})};Element.getInlineOpacity=function(n){return $(n).style.opacity||""};Element.forceRerendering=function(n){try{n=$(n);var t=document.createTextNode(" ");n.appendChild(t);n.removeChild(t)}catch(i){}};Array.prototype.call=function(){var n=arguments;this.each(function(t){t.apply(this,n)})};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},tagifyText:function(n){if(typeof Builder=="undefined")throw"Effect.tagifyText requires including script.aculo.us' builder.js library";var t="position:relative";/MSIE/.test(navigator.userAgent)&&!window.opera&&(t+=";zoom:1");n=$(n);$A(n.childNodes).each(function(i){i.nodeType==3&&(i.nodeValue.toArray().each(function(r){n.insertBefore(Builder.node("span",{style:t},r==" "?String.fromCharCode(160):r),i)}),Element.remove(i))})},multiple:function(n,t){var r,i,u;r=(typeof n=="object"||typeof n=="function")&&n.length?n:$(n).childNodes;i=Object.extend({speed:.1,delay:0},arguments[2]||{});u=i.delay;$A(r).each(function(n,r){new t(n,Object.extend(i,{delay:r*i.speed+u}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(n,t){n=$(n);t=(t||"appear").toLowerCase();var i=Object.extend({queue:{position:"end",scope:n.id||"global",limit:1}},arguments[2]||{});Effect[n.visible()?Effect.PAIRS[t][1]:Effect.PAIRS[t][0]](n,i)}},Effect2=Effect;Effect.Transitions={linear:Prototype.K,sinoidal:function(n){return-Math.cos(n*Math.PI)/2+.5},reverse:function(n){return 1-n},flicker:function(n){return-Math.cos(n*Math.PI)/4+.75+Math.random()/4},wobble:function(n){return-Math.cos(n*Math.PI*9*n)/2+.5},pulse:function(n,t){return t=t||5,Math.round(n%(1/t)*t)==0?n*t*2-Math.floor(n*t*2):1-(n*t*2-Math.floor(n*t*2))},none:function(){return 0},full:function(){return 1}};Effect.ScopedQueue=Class.create();Object.extend(Object.extend(Effect.ScopedQueue.prototype,Enumerable),{initialize:function(){this.effects=[];this.interval=null},_each:function(n){this.effects._each(n)},add:function(n){var t=(new Date).getTime(),i=typeof n.options.queue=="string"?n.options.queue:n.options.queue.position;switch(i){case"front":this.effects.findAll(function(n){return n.state=="idle"}).each(function(t){t.startOn+=n.finishOn;t.finishOn+=n.finishOn});break;case"with-last":t=this.effects.pluck("startOn").max()||t;break;case"end":t=this.effects.pluck("finishOn").max()||t}n.startOn+=t;n.finishOn+=t;(!n.options.queue.limit||this.effects.length<n.options.queue.limit)&&this.effects.push(n);this.interval||(this.interval=setInterval(this.loop.bind(this),15))},remove:function(n){this.effects=this.effects.reject(function(t){return t==n});this.effects.length==0&&(clearInterval(this.interval),this.interval=null)},loop:function(){for(var t=(new Date).getTime(),n=0,i=this.effects.length;n<i;n++)this.effects[n]&&this.effects[n].loop(t)}});Effect.Queues={instances:$H(),get:function(n){return typeof n!="string"?n:(this.instances[n]||(this.instances[n]=new Effect.ScopedQueue),this.instances[n])}};Effect.Queue=Effect.Queues.get("global");Effect.DefaultOptions={transition:Effect.Transitions.sinoidal,duration:1,fps:60,sync:!1,from:0,to:1,delay:0,queue:"parallel"};Effect.Base=function(){};Effect.Base.prototype={position:null,start:function(n){this.options=Object.extend(Object.extend({},Effect.DefaultOptions),n||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1e3;this.finishOn=this.startOn+this.options.duration*1e3;this.event("beforeStart");this.options.sync||Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).add(this)},loop:function(n){if(n>=this.startOn){if(n>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");this.finish&&this.finish();this.event("afterFinish");return}var t=(n-this.startOn)/(this.finishOn-this.startOn),i=Math.round(t*this.options.fps*this.options.duration);i>this.currentFrame&&(this.render(t),this.currentFrame=i)}},render:function(n){this.state=="idle"&&(this.state="running",this.event("beforeSetup"),this.setup&&this.setup(),this.event("afterSetup"));this.state=="running"&&(this.options.transition&&(n=this.options.transition(n)),n*=this.options.to-this.options.from,n+=this.options.from,this.position=n,this.event("beforeUpdate"),this.update&&this.update(n),this.event("afterUpdate"))},cancel:function(){this.options.sync||Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).remove(this);this.state="finished"},event:function(n){this.options[n+"Internal"]&&this.options[n+"Internal"](this);this.options[n]&&this.options[n](this)},inspect:function(){var n=$H();for(property in this)typeof this[property]!="function"&&(n[property]=this[property]);return"#<Effect:"+n.inspect()+",options:"+$H(this.options).inspect()+">"}};Effect.Parallel=Class.create();Object.extend(Object.extend(Effect.Parallel.prototype,Effect.Base.prototype),{initialize:function(n){this.effects=n||[];this.start(arguments[1])},update:function(n){this.effects.invoke("render",n)},finish:function(n){this.effects.each(function(t){t.render(1);t.cancel();t.event("beforeFinish");t.finish&&t.finish(n);t.event("afterFinish")})}});Effect.Event=Class.create();Object.extend(Object.extend(Effect.Event.prototype,Effect.Base.prototype),{initialize:function(){var n=Object.extend({duration:0},arguments[0]||{});this.start(n)},update:Prototype.emptyFunction});Effect.Opacity=Class.create();Object.extend(Object.extend(Effect.Opacity.prototype,Effect.Base.prototype),{initialize:function(n){if(this.element=$(n),!this.element)throw Effect._elementDoesNotExistError;!/MSIE/.test(navigator.userAgent)||window.opera||this.element.currentStyle.hasLayout||this.element.setStyle({zoom:1});var t=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(t)},update:function(n){this.element.setOpacity(n)}});Effect.Move=Class.create();Object.extend(Object.extend(Effect.Move.prototype,Effect.Base.prototype),{initialize:function(n){if(this.element=$(n),!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(t)},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");this.options.mode=="absolute"&&(this.options.x=this.options.x-this.originalLeft,this.options.y=this.options.y-this.originalTop)},update:function(n){this.element.setStyle({left:Math.round(this.options.x*n+this.originalLeft)+"px",top:Math.round(this.options.y*n+this.originalTop)+"px"})}});Effect.MoveBy=function(n,t,i){return new Effect.Move(n,Object.extend({x:i,y:t},arguments[3]||{}))};Effect.Scale=Class.create();Object.extend(Object.extend(Effect.Scale.prototype,Effect.Base.prototype),{initialize:function(n,t){if(this.element=$(n),!this.element)throw Effect._elementDoesNotExistError;var i=Object.extend({scaleX:!0,scaleY:!0,scaleContent:!0,scaleFromCenter:!1,scaleMode:"box",scaleFrom:100,scaleTo:t},arguments[2]||{});this.start(i)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||!1;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(n){this.originalStyle[n]=this.element.style[n]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var n=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(t){n.indexOf(t)>0&&(this.fontSize=parseFloat(n),this.fontSizeType=t)}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;this.options.scaleMode=="box"&&(this.dims=[this.element.offsetHeight,this.element.offsetWidth]);/^content/.test(this.options.scaleMode)&&(this.dims=[this.element.scrollHeight,this.element.scrollWidth]);this.dims||(this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth])},update:function(n){var t=this.options.scaleFrom/100+this.factor*n;this.options.scaleContent&&this.fontSize&&this.element.setStyle({fontSize:this.fontSize*t+this.fontSizeType});this.setDimensions(this.dims[0]*t,this.dims[1]*t)},finish:function(){this.restoreAfterFinish&&this.element.setStyle(this.originalStyle)},setDimensions:function(n,t){var i={},r,u;this.options.scaleX&&(i.width=Math.round(t)+"px");this.options.scaleY&&(i.height=Math.round(n)+"px");this.options.scaleFromCenter&&(r=(n-this.dims[0])/2,u=(t-this.dims[1])/2,this.elementPositioning=="absolute"?(this.options.scaleY&&(i.top=this.originalTop-r+"px"),this.options.scaleX&&(i.left=this.originalLeft-u+"px")):(this.options.scaleY&&(i.top=-r+"px"),this.options.scaleX&&(i.left=-u+"px")));this.element.setStyle(i)}});Effect.Highlight=Class.create();Object.extend(Object.extend(Effect.Highlight.prototype,Effect.Base.prototype),{initialize:function(n){if(this.element=$(n),!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(t)},setup:function(){if(this.element.getStyle("display")=="none"){this.cancel();return}this.oldStyle={};this.options.keepBackgroundImage||(this.oldStyle.backgroundImage=this.element.getStyle("background-image"),this.element.setStyle({backgroundImage:"none"}));this.options.endcolor||(this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff"));this.options.restorecolor||(this.options.restorecolor=this.element.getStyle("background-color"));this._base=$R(0,2).map(function(n){return parseInt(this.options.startcolor.slice(n*2+1,n*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(n){return parseInt(this.options.endcolor.slice(n*2+1,n*2+3),16)-this._base[n]}.bind(this))},update:function(n){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(t,i,r){return t+Math.round(this._base[r]+this._delta[r]*n).toColorPart()}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=Class.create();Object.extend(Object.extend(Effect.ScrollTo.prototype,Effect.Base.prototype),{initialize:function(n){this.element=$(n);this.start(arguments[1]||{})},setup:function(){var n,t;Position.prepare();n=Position.cumulativeOffset(this.element);this.options.offset&&(n[1]+=this.options.offset);t=window.innerHeight?window.height-window.innerHeight:document.body.scrollHeight-(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight);this.scrollStart=Position.deltaY;this.delta=(n[1]>t?t:n[1])-this.scrollStart},update:function(n){Position.prepare();window.scrollTo(Position.deltaX,this.scrollStart+n*this.delta)}});Effect.Fade=function(n){n=$(n);var t=n.getInlineOpacity(),i=Object.extend({from:n.getOpacity()||1,to:0,afterFinishInternal:function(n){n.options.to==0&&n.element.hide().setStyle({opacity:t})}},arguments[1]||{});return new Effect.Opacity(n,i)};Effect.Appear=function(n){n=$(n);var t=Object.extend({from:n.getStyle("display")=="none"?0:n.getOpacity()||0,to:1,afterFinishInternal:function(n){n.element.forceRerendering()},beforeSetup:function(n){n.element.setOpacity(n.options.from).show()}},arguments[1]||{});return new Effect.Opacity(n,t)};Effect.Puff=function(n){n=$(n);var t={opacity:n.getInlineOpacity(),position:n.getStyle("position"),top:n.style.top,left:n.style.left,width:n.style.width,height:n.style.height};return new Effect.Parallel([new Effect.Scale(n,200,{sync:!0,scaleFromCenter:!0,scaleContent:!0,restoreAfterFinish:!0}),new Effect.Opacity(n,{sync:!0,to:0})],Object.extend({duration:1,beforeSetupInternal:function(n){Position.absolutize(n.effects[0].element)},afterFinishInternal:function(n){n.effects[0].element.hide().setStyle(t)}},arguments[1]||{}))};Effect.BlindUp=function(n){return n=$(n),n.makeClipping(),new Effect.Scale(n,0,Object.extend({scaleContent:!1,scaleX:!1,restoreAfterFinish:!0,afterFinishInternal:function(n){n.element.hide().undoClipping()}},arguments[1]||{}))};Effect.BlindDown=function(n){n=$(n);var t=n.getDimensions();return new Effect.Scale(n,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:t.height,originalWidth:t.width},restoreAfterFinish:!0,afterSetup:function(n){n.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(n){n.element.undoClipping()}},arguments[1]||{}))};Effect.SwitchOff=function(n){n=$(n);var t=n.getInlineOpacity();return new Effect.Appear(n,Object.extend({duration:.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(n){new Effect.Scale(n.element,1,{duration:.3,scaleFromCenter:!0,scaleX:!1,scaleContent:!1,restoreAfterFinish:!0,beforeSetup:function(n){n.element.makePositioned().makeClipping()},afterFinishInternal:function(n){n.element.hide().undoClipping().undoPositioned().setStyle({opacity:t})}})}},arguments[1]||{}))};Effect.DropOut=function(n){n=$(n);var t={top:n.getStyle("top"),left:n.getStyle("left"),opacity:n.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(n,{x:0,y:100,sync:!0}),new Effect.Opacity(n,{sync:!0,to:0})],Object.extend({duration:.5,beforeSetup:function(n){n.effects[0].element.makePositioned()},afterFinishInternal:function(n){n.effects[0].element.hide().undoPositioned().setStyle(t)}},arguments[1]||{}))};Effect.Shake=function(n){n=$(n);var t={top:n.getStyle("top"),left:n.getStyle("left")};return new Effect.Move(n,{x:20,y:0,duration:.05,afterFinishInternal:function(n){new Effect.Move(n.element,{x:-40,y:0,duration:.1,afterFinishInternal:function(n){new Effect.Move(n.element,{x:40,y:0,duration:.1,afterFinishInternal:function(n){new Effect.Move(n.element,{x:-40,y:0,duration:.1,afterFinishInternal:function(n){new Effect.Move(n.element,{x:40,y:0,duration:.1,afterFinishInternal:function(n){new Effect.Move(n.element,{x:-20,y:0,duration:.05,afterFinishInternal:function(n){n.element.undoPositioned().setStyle(t)}})}})}})}})}})}})};Effect.SlideDown=function(n){n=$(n).cleanWhitespace();var i=n.down().getStyle("bottom"),t=n.getDimensions();return new Effect.Scale(n,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:t.height,originalWidth:t.width},restoreAfterFinish:!0,afterSetup:function(n){n.element.makePositioned();n.element.down().makePositioned();window.opera&&n.element.setStyle({top:""});n.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(n){n.element.down().setStyle({bottom:n.dims[0]-n.element.clientHeight+"px"})},afterFinishInternal:function(n){n.element.undoClipping().undoPositioned();n.element.down().undoPositioned().setStyle({bottom:i})}},arguments[1]||{}))};Effect.SlideUp=function(n){n=$(n).cleanWhitespace();var t=n.down().getStyle("bottom");return new Effect.Scale(n,window.opera?0:1,Object.extend({scaleContent:!1,scaleX:!1,scaleMode:"box",scaleFrom:100,restoreAfterFinish:!0,beforeStartInternal:function(n){n.element.makePositioned();n.element.down().makePositioned();window.opera&&n.element.setStyle({top:""});n.element.makeClipping().show()},afterUpdateInternal:function(n){n.element.down().setStyle({bottom:n.dims[0]-n.element.clientHeight+"px"})},afterFinishInternal:function(n){n.element.hide().undoClipping().undoPositioned().setStyle({bottom:t});n.element.down().undoPositioned()}},arguments[1]||{}))};Effect.Squish=function(n){return new Effect.Scale(n,window.opera?1:0,{restoreAfterFinish:!0,beforeSetup:function(n){n.element.makeClipping()},afterFinishInternal:function(n){n.element.hide().undoClipping()}})};Effect.Grow=function(n){n=$(n);var e=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{}),o={top:n.style.top,left:n.style.left,height:n.style.height,width:n.style.width,opacity:n.getInlineOpacity()},t=n.getDimensions(),i,r,u,f;switch(e.direction){case"top-left":i=r=u=f=0;break;case"top-right":i=t.width;r=f=0;u=-t.width;break;case"bottom-left":i=u=0;r=t.height;f=-t.height;break;case"bottom-right":i=t.width;r=t.height;u=-t.width;f=-t.height;break;case"center":i=t.width/2;r=t.height/2;u=-t.width/2;f=-t.height/2}return new Effect.Move(n,{x:i,y:r,duration:.01,beforeSetup:function(n){n.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(n){new Effect.Parallel([new Effect.Opacity(n.element,{sync:!0,to:1,from:0,transition:e.opacityTransition}),new Effect.Move(n.element,{x:u,y:f,sync:!0,transition:e.moveTransition}),new Effect.Scale(n.element,100,{scaleMode:{originalHeight:t.height,originalWidth:t.width},sync:!0,scaleFrom:window.opera?1:0,transition:e.scaleTransition,restoreAfterFinish:!0})],Object.extend({beforeSetup:function(n){n.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(n){n.effects[0].element.undoClipping().undoPositioned().setStyle(o)}},e))}})};Effect.Shrink=function(n){n=$(n);var u=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{}),f={top:n.style.top,left:n.style.left,height:n.style.height,width:n.style.width,opacity:n.getInlineOpacity()},t=n.getDimensions(),i,r;switch(u.direction){case"top-left":i=r=0;break;case"top-right":i=t.width;r=0;break;case"bottom-left":i=0;r=t.height;break;case"bottom-right":i=t.width;r=t.height;break;case"center":i=t.width/2;r=t.height/2}return new Effect.Parallel([new Effect.Opacity(n,{sync:!0,to:0,from:1,transition:u.opacityTransition}),new Effect.Scale(n,window.opera?1:0,{sync:!0,transition:u.scaleTransition,restoreAfterFinish:!0}),new Effect.Move(n,{x:i,y:r,sync:!0,transition:u.moveTransition})],Object.extend({beforeStartInternal:function(n){n.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(n){n.effects[0].element.hide().undoClipping().undoPositioned().setStyle(f)}},u))};Effect.Pulsate=function(n){n=$(n);var t=arguments[1]||{},u=n.getInlineOpacity(),i=t.transition||Effect.Transitions.sinoidal,r=function(n){return i(1-Effect.Transitions.pulse(n,t.pulses))};return r.bind(i),new Effect.Opacity(n,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(n){n.element.setStyle({opacity:u})}},t),{transition:r}))};Effect.Fold=function(n){n=$(n);var t={top:n.style.top,left:n.style.left,width:n.style.width,height:n.style.height};return n.makeClipping(),new Effect.Scale(n,5,Object.extend({scaleContent:!1,scaleX:!1,afterFinishInternal:function(){new Effect.Scale(n,1,{scaleContent:!1,scaleY:!1,afterFinishInternal:function(n){n.element.hide().undoClipping().setStyle(t)}})}},arguments[1]||{}))};Effect.Morph=Class.create();Object.extend(Object.extend(Effect.Morph.prototype,Effect.Base.prototype),{initialize:function(n){var t,i,r;if(this.element=$(n),!this.element)throw Effect._elementDoesNotExistError;t=Object.extend({style:{}},arguments[1]||{});typeof t.style=="string"?t.style.indexOf(":")==-1?(i="",r="."+t.style,$A(document.styleSheets).reverse().each(function(n){if(n.cssRules?cssRules=n.cssRules:n.rules&&(cssRules=n.rules),$A(cssRules).reverse().each(function(n){if(r==n.selectorText){i=n.style.cssText;throw $break;}}),i)throw $break;}),this.style=i.parseStyle(),t.afterFinishInternal=function(n){n.element.addClassName(n.options.style);n.transforms.each(function(t){t.style!="opacity"&&(n.element.style[t.style.camelize()]="")})}):this.style=t.style.parseStyle():this.style=$H(t.style);this.start(t)},setup:function(){function n(n){return(!n||["rgba(0, 0, 0, 0)","transparent"].include(n))&&(n="#ffffff"),n=n.parseColor(),$R(0,2).map(function(t){return parseInt(n.slice(t*2+1,t*2+3),16)})}this.transforms=this.style.map(function(t){var u=t[0].underscore().dasherize(),i=t[1],r=null,e;if(i.parseColor("#zzzzzz")!="#zzzzzz")i=i.parseColor(),r="color";else if(u=="opacity")i=parseFloat(i),!/MSIE/.test(navigator.userAgent)||window.opera||this.element.currentStyle.hasLayout||this.element.setStyle({zoom:1});else if(Element.CSS_LENGTH.test(i))var f=i.match(/^([\+\-]?[0-9\.]+)(.*)$/),i=parseFloat(f[1]),r=f.length==3?f[2]:null;return e=this.element.getStyle(u),$H({style:u,originalValue:r=="color"?n(e):parseFloat(e||0),targetValue:r=="color"?n(i):i,unit:r})}.bind(this)).reject(function(n){return n.originalValue==n.targetValue||n.unit!="color"&&(isNaN(n.originalValue)||isNaN(n.targetValue))})},update:function(n){var t=$H(),i=null;this.transforms.each(function(r){i=r.unit=="color"?$R(0,2).inject("#",function(t,i,u){return t+Math.round(r.originalValue[u]+(r.targetValue[u]-r.originalValue[u])*n).toColorPart()}):r.originalValue+Math.round((r.targetValue-r.originalValue)*n*1e3)/1e3+r.unit;t[r.style]=i});this.element.setStyle(t)}});Effect.Transform=Class.create();Object.extend(Effect.Transform.prototype,{initialize:function(n){this.tracks=[];this.options=arguments[1]||{};this.addTracks(n)},addTracks:function(n){return n.each(function(n){var t=$H(n).values().first();this.tracks.push($H({ids:$H(n).keys().first(),effect:Effect.Morph,options:{style:t}}))}.bind(this)),this},play:function(){return new Effect.Parallel(this.tracks.map(function(n){var t=[$(n.ids)||$$(n.ids)].flatten();return t.map(function(t){return new n.effect(t,Object.extend({sync:!0},n.options))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.prototype.parseStyle=function(){var i=Element.extend(document.createElement("div")),t,n;return i.innerHTML='<div style="'+this+'"><\/div>',t=i.down().style,n=$H(),Element.CSS_PROPERTIES.each(function(i){t[i]&&(n[i]=t[i])}),/MSIE/.test(navigator.userAgent)&&!window.opera&&this.indexOf("opacity")>-1&&(n.opacity=this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]),n};Element.morph=function(n,t){return new Effect.Morph(n,Object.extend({style:t},arguments[2]||{})),n};["setOpacity","getOpacity","getInlineOpacity","forceRerendering","setContentZoom","collectTextNodes","collectTextNodesIgnoreClass","morph"].each(function(n){Element.Methods[n]=Element[n]});Element.Methods.visualEffect=function(n,t,i){return s=t.gsub(/_/,"-").camelize(),effect_class=s.charAt(0).toUpperCase()+s.substring(1),new Effect[effect_class](n,i),$(n)};Element.addMethods()