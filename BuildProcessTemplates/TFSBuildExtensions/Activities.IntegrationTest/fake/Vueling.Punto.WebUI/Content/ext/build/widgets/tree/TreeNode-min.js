Ext.tree.TreeNode=function(n){n=n||{};typeof n=="string"&&(n={text:n});this.childrenRendered=!1;this.rendered=!1;Ext.tree.TreeNode.superclass.constructor.call(this,n);this.expanded=n.expanded===!0;this.isTarget=n.isTarget!==!1;this.draggable=n.draggable!==!1&&n.allowDrag!==!1;this.allowChildren=n.allowChildren!==!1&&n.allowDrop!==!1;this.text=n.text;this.disabled=n.disabled===!0;this.addEvents("textchange","beforeexpand","beforecollapse","expand","disabledchange","collapse","beforeclick","click","checkchange","dblclick","contextmenu","beforechildrenrendered");var t=this.attributes.uiProvider||this.defaultUI||Ext.tree.TreeNodeUI;this.ui=new t(this)};Ext.extend(Ext.tree.TreeNode,Ext.data.Node,{preventHScroll:!0,isExpanded:function(){return this.expanded},getUI:function(){return this.ui},setFirstChild:function(n){var t=this.firstChild;Ext.tree.TreeNode.superclass.setFirstChild.call(this,n);this.childrenRendered&&t&&n!=t&&t.renderIndent(!0,!0);this.rendered&&this.renderIndent(!0,!0)},setLastChild:function(n){var t=this.lastChild;Ext.tree.TreeNode.superclass.setLastChild.call(this,n);this.childrenRendered&&t&&n!=t&&t.renderIndent(!0,!0);this.rendered&&this.renderIndent(!0,!0)},appendChild:function(){var n=Ext.tree.TreeNode.superclass.appendChild.apply(this,arguments);return n&&this.childrenRendered&&n.render(),this.ui.updateExpandIcon(),n},removeChild:function(n){return this.ownerTree.getSelectionModel().unselect(n),Ext.tree.TreeNode.superclass.removeChild.apply(this,arguments),this.childrenRendered&&n.ui.remove(),this.childNodes.length<1?this.collapse(!1,!1):this.ui.updateExpandIcon(),this.firstChild||this.isHiddenRoot()||(this.childrenRendered=!1),n},insertBefore:function(n,t){var i=Ext.tree.TreeNode.superclass.insertBefore.apply(this,arguments);return i&&t&&this.childrenRendered&&n.render(),this.ui.updateExpandIcon(),i},setText:function(n){var t=this.text;if(this.text=n,this.attributes.text=n,this.rendered)this.ui.onTextChange(this,n,t);this.fireEvent("textchange",this,n,t)},select:function(){this.getOwnerTree().getSelectionModel().select(this)},unselect:function(){this.getOwnerTree().getSelectionModel().unselect(this)},isSelected:function(){return this.getOwnerTree().getSelectionModel().isSelected(this)},expand:function(n,t,i){if(this.expanded)typeof i=="function"&&i(this);else{if(this.fireEvent("beforeexpand",this,n,t)===!1)return;if(this.childrenRendered||this.renderChildren(),this.expanded=!0,!this.isHiddenRoot()&&this.getOwnerTree().animate&&t!==!1||t){this.ui.animExpand(function(){this.fireEvent("expand",this);typeof i=="function"&&i(this);n===!0&&this.expandChildNodes(!0)}.createDelegate(this));return}this.ui.expand();this.fireEvent("expand",this);typeof i=="function"&&i(this)}n===!0&&this.expandChildNodes(!0)},isHiddenRoot:function(){return this.isRoot&&!this.getOwnerTree().rootVisible},collapse:function(n,t){var r,i,u;if(this.expanded&&!this.isHiddenRoot()){if(this.fireEvent("beforecollapse",this,n,t)===!1)return;if(this.expanded=!1,this.getOwnerTree().animate&&t!==!1||t){this.ui.animCollapse(function(){this.fireEvent("collapse",this);n===!0&&this.collapseChildNodes(!0)}.createDelegate(this));return}this.ui.collapse();this.fireEvent("collapse",this)}if(n===!0)for(r=this.childNodes,i=0,u=r.length;i<u;i++)r[i].collapse(!0,!1)},delayedExpand:function(n){this.expandProcId||(this.expandProcId=this.expand.defer(n,this))},cancelExpand:function(){this.expandProcId&&clearTimeout(this.expandProcId);this.expandProcId=!1},toggle:function(){this.expanded?this.collapse():this.expand()},ensureVisible:function(n){var t=this.getOwnerTree();t.expandPath(this.parentNode.getPath(),!1,function(){var i=t.getNodeById(this.id);t.getTreeEl().scrollChildIntoView(i.ui.anchor);Ext.callback(n)}.createDelegate(this))},expandChildNodes:function(n){for(var i=this.childNodes,t=0,r=i.length;t<r;t++)i[t].expand(n)},collapseChildNodes:function(n){for(var i=this.childNodes,t=0,r=i.length;t<r;t++)i[t].collapse(n)},disable:function(){if(this.disabled=!0,this.unselect(),this.rendered&&this.ui.onDisableChange)this.ui.onDisableChange(this,!0);this.fireEvent("disabledchange",this,!0)},enable:function(){if(this.disabled=!1,this.rendered&&this.ui.onDisableChange)this.ui.onDisableChange(this,!1);this.fireEvent("disabledchange",this,!1)},renderChildren:function(n){var i,t,r;for(n!==!1&&this.fireEvent("beforechildrenrendered",this),i=this.childNodes,t=0,r=i.length;t<r;t++)i[t].render(!0);this.childrenRendered=!0},sort:function(){var t,n,i;if(Ext.tree.TreeNode.superclass.sort.apply(this,arguments),this.childrenRendered)for(t=this.childNodes,n=0,i=t.length;n<i;n++)t[n].render(!0)},render:function(n){this.ui.render(n);this.rendered||(this.getOwnerTree().registerNode(this),this.rendered=!0,this.expanded&&(this.expanded=!1,this.expand(!1,!1)))},renderIndent:function(n,t){var r,i,u;if(t&&(this.ui.childIndent=null),this.ui.renderIndent(),n===!0&&this.childrenRendered)for(r=this.childNodes,i=0,u=r.length;i<u;i++)r[i].renderIndent(!0,t)},beginUpdate:function(){this.childrenRendered=!1},endUpdate:function(){this.expanded&&this.renderChildren()},destroy:function(){for(var n=0,t=this.childNodes.length;n<t;n++)this.childNodes[n].destroy();this.childNodes=null;this.ui.destroy&&this.ui.destroy()}})