YAHOO.util.Connect={_msxml_progid:["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],_http_headers:{},_has_http_headers:!1,_use_default_post_header:!0,_default_post_header:"application/x-www-form-urlencoded",_use_default_xhr_header:!0,_default_xhr_header:"XMLHttpRequest",_has_default_headers:!0,_default_headers:{},_isFormSubmit:!1,_isFileUpload:!1,_formNode:null,_sFormData:null,_poll:{},_timeOut:{},_polling_interval:50,_transaction_id:0,setProgId:function(n){this._msxml_progid.unshift(n)},setDefaultPostHeader:function(n){this._use_default_post_header=n},setDefaultXhrHeader:function(n){this._use_default_xhr_header=n},setPollingInterval:function(n){typeof n=="number"&&isFinite(n)&&(this._polling_interval=n)},createXhrObject:function(n){var r,t,i;try{t=new XMLHttpRequest;r={conn:t,tId:n}}catch(u){for(i=0;i<this._msxml_progid.length;++i)try{t=new ActiveXObject(this._msxml_progid[i]);r={conn:t,tId:n};break}catch(u){}}finally{return r}},getConnectionObject:function(){var n,t=this._transaction_id;try{n=this.createXhrObject(t);n&&this._transaction_id++}catch(i){}finally{return n}},asyncRequest:function(n,t,i,r){var u=this.getConnectionObject();if(u){if(this._isFormSubmit){if(this._isFileUpload){this.uploadFile(u.tId,i,t,r);this.releaseObject(u);return}n.toUpperCase()=="GET"?t+=this._sFormData.length!=0?(t.indexOf("?")==-1?"?":"&")+this._sFormData:"?"+this._sFormData:n.toUpperCase()=="POST"&&(r=r?this._sFormData+"&"+r:this._sFormData)}return u.conn.open(n,t,!0),this._use_default_xhr_header&&(this._default_headers["X-Requested-With"]||this.initHeader("X-Requested-With",this._default_xhr_header,!0)),(this._isFormSubmit||r&&this._use_default_post_header)&&(this.initHeader("Content-Type",this._default_post_header),this._isFormSubmit&&this.resetFormState()),(this._has_default_headers||this._has_http_headers)&&this.setHeader(u),this.handleReadyState(u,i),u.conn.send(r||null),u}return null},handleReadyState:function(n,t){var i=this;t&&t.timeout&&(this._timeOut[n.tId]=window.setTimeout(function(){i.abort(n,t,!0)},t.timeout));this._poll[n.tId]=window.setInterval(function(){n.conn&&n.conn.readyState==4&&(window.clearInterval(i._poll[n.tId]),delete i._poll[n.tId],t&&t.timeout&&delete i._timeOut[n.tId],i.handleTransactionResponse(n,t))},this._polling_interval)},handleTransactionResponse:function(n,t,i){if(!t){this.releaseObject(n);return}var u,r;try{u=n.conn.status!==undefined&&n.conn.status!=0?n.conn.status:13030}catch(f){u=13030}if(u>=200&&u<300)r=this.createResponseObject(n,t.argument),t.success&&(t.scope?t.success.apply(t.scope,[r]):t.success(r));else switch(u){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:r=this.createExceptionObject(n.tId,t.argument,i?i:!1);t.failure&&(t.scope?t.failure.apply(t.scope,[r]):t.failure(r));break;default:r=this.createResponseObject(n,t.argument);t.failure&&(t.scope?t.failure.apply(t.scope,[r]):t.failure(r))}this.releaseObject(n);r=null},createResponseObject:function(n,t){var i={},o={},e,u,r,f;try{for(e=n.conn.getAllResponseHeaders(),u=e.split("\n"),r=0;r<u.length;r++)f=u[r].indexOf(":"),f!=-1&&(o[u[r].substring(0,f)]=u[r].substring(f+2))}catch(s){}return i.tId=n.tId,i.status=n.conn.status,i.statusText=n.conn.statusText,i.getResponseHeader=o,i.getAllResponseHeaders=e,i.responseText=n.conn.responseText,i.responseXML=n.conn.responseXML,typeof t!==undefined&&(i.argument=t),i},createExceptionObject:function(n,t,i){var r={};return r.tId=n,i?(r.status=-1,r.statusText="transaction aborted"):(r.status=0,r.statusText="communication failure"),t&&(r.argument=t),r},initHeader:function(n,t,i){var r=i?this._default_headers:this._http_headers;r[n]=r[n]===undefined?t:t+","+r[n];i?this._has_default_headers=!0:this._has_http_headers=!0},setHeader:function(n){var t;if(this._has_default_headers)for(t in this._default_headers)YAHOO.lang.hasOwnProperty(this._default_headers,t)&&n.conn.setRequestHeader(t,this._default_headers[t]);if(this._has_http_headers){for(t in this._http_headers)YAHOO.lang.hasOwnProperty(this._http_headers,t)&&n.conn.setRequestHeader(t,this._http_headers[t]);delete this._http_headers;this._http_headers={};this._has_http_headers=!1}},resetDefaultHeaders:function(){delete this._default_headers;this._default_headers={};this._has_default_headers=!1},setForm:function(n,t,i){var f,r,e,s,c,h,o,u;if(this.resetFormState(),typeof n=="string")f=document.getElementById(n)||document.forms[n];else if(typeof n=="object")f=n;else return;if(t){this.createFrame(i?i:null);this._isFormSubmit=!0;this._isFileUpload=!0;this._formNode=f;return}for(h=!1,o=0;o<f.elements.length;o++)if(r=f.elements[o],c=f.elements[o].disabled,e=f.elements[o].name,s=f.elements[o].value,!c&&e)switch(r.type){case"select-one":case"select-multiple":for(u=0;u<r.options.length;u++)r.options[u].selected&&(this._sFormData+=window.ActiveXObject?encodeURIComponent(e)+"="+encodeURIComponent(r.options[u].attributes.value.specified?r.options[u].value:r.options[u].text)+"&":encodeURIComponent(e)+"="+encodeURIComponent(r.options[u].hasAttribute("value")?r.options[u].value:r.options[u].text)+"&");break;case"radio":case"checkbox":r.checked&&(this._sFormData+=encodeURIComponent(e)+"="+encodeURIComponent(s)+"&");break;case"file":case undefined:case"reset":case"button":break;case"submit":h==!1&&(this._sFormData+=encodeURIComponent(e)+"="+encodeURIComponent(s)+"&",h=!0);break;default:this._sFormData+=encodeURIComponent(e)+"="+encodeURIComponent(s)+"&"}return this._isFormSubmit=!0,this._sFormData=this._sFormData.substr(0,this._sFormData.length-1),this._sFormData},resetFormState:function(){this._isFormSubmit=!1;this._isFileUpload=!1;this._formNode=null;this._sFormData=""},createFrame:function(n){var i="yuiIO"+this._transaction_id,t;window.ActiveXObject?(t=document.createElement('<iframe id="'+i+'" name="'+i+'" />'),typeof n=="boolean"?t.src="javascript:false":typeof secureURI=="string"&&(t.src=n)):(t=document.createElement("iframe"),t.id=i,t.name=i);t.style.position="absolute";t.style.top="-1000px";t.style.left="-1000px";document.body.appendChild(t)},appendPostData:function(n){for(var u,i=[],r=n.split("&"),t=0;t<r.length;t++)u=r[t].indexOf("="),u!=-1&&(i[t]=document.createElement("input"),i[t].type="hidden",i[t].name=r[t].substring(0,u),i[t].value=r[t].substring(u+1),this._formNode.appendChild(i[t]));return i},uploadFile:function(n,t,i,r){var s="yuiIO"+n,h="multipart/form-data",u=document.getElementById(s),e,o,f;if(this._formNode.action=i,this._formNode.method="POST",this._formNode.target=s,this._formNode.encoding?this._formNode.encoding=h:this._formNode.enctype=h,r&&(e=this.appendPostData(r)),this._formNode.submit(),e&&e.length>0)for(o=0;o<e.length;o++)this._formNode.removeChild(e[o]);this.resetFormState();f=function(){var i={};i.tId=n;i.argument=t.argument;try{i.responseText=u.contentWindow.document.body?u.contentWindow.document.body.innerHTML:null;i.responseXML=u.contentWindow.document.XMLDocument?u.contentWindow.document.XMLDocument:u.contentWindow.document}catch(r){}t&&t.upload&&(t.scope?t.upload.apply(t.scope,[i]):t.upload(i));YAHOO.util.Event?YAHOO.util.Event.removeListener(u,"load",f):window.detachEvent?u.detachEvent("onload",f):u.removeEventListener("load",f,!1);setTimeout(function(){document.body.removeChild(u)},100)};YAHOO.util.Event?YAHOO.util.Event.addListener(u,"load",f):window.attachEvent?u.attachEvent("onload",f):u.addEventListener("load",f,!1)},abort:function(n,t,i){return this.isCallInProgress(n)?(n.conn.abort(),window.clearInterval(this._poll[n.tId]),delete this._poll[n.tId],i&&delete this._timeOut[n.tId],this.handleTransactionResponse(n,t,!0),!0):!1},isCallInProgress:function(n){return n.conn?n.conn.readyState!=4&&n.conn.readyState!=0:!1},releaseObject:function(n){n.conn=null;n=null}};YAHOO.register("connection",YAHOO.widget.Module,{version:"2.2.0",build:"127"})