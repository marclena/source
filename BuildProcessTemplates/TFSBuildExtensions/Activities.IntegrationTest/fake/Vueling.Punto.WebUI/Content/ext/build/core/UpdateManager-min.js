Ext.Updater=function(n,t){if(n=Ext.get(n),!t&&n.updateManager)return n.updateManager;this.el=n;this.defaultUrl=null;this.addEvents("beforeupdate","update","failure");var i=Ext.Updater.defaults;this.sslBlankUrl=i.sslBlankUrl;this.disableCaching=i.disableCaching;this.indicatorText=i.indicatorText;this.showLoadIndicator=i.showLoadIndicator;this.timeout=i.timeout;this.loadScripts=i.loadScripts;this.transaction=null;this.autoRefreshProcId=null;this.refreshDelegate=this.refresh.createDelegate(this);this.updateDelegate=this.update.createDelegate(this);this.formUpdateDelegate=this.formUpdate.createDelegate(this);this.renderer||(this.renderer=new Ext.Updater.BasicRenderer);Ext.Updater.superclass.constructor.call(this)};Ext.extend(Ext.Updater,Ext.util.Observable,{getEl:function(){return this.el},update:function(n,t,i,r){var f,u,e,o;this.fireEvent("beforeupdate",this.el,n,t)!==!1&&(f=this.method,typeof n=="object"&&(u=n,n=u.url,t=t||u.params,i=i||u.callback,r=r||u.discardUrl,e=u.scope,typeof u.method!="undefined"&&(f=u.method),typeof u.nocache!="undefined"&&(this.disableCaching=u.nocache),typeof u.text!="undefined"&&(this.indicatorText='<div class="loading-indicator">'+u.text+"<\/div>"),typeof u.scripts!="undefined"&&(this.loadScripts=u.scripts),typeof u.timeout!="undefined"&&(this.timeout=u.timeout)),this.showLoading(),r||(this.defaultUrl=n),typeof n=="function"&&(n=n.call(this)),f=f||(t?"POST":"GET"),f=="GET"&&(n=this.prepareUrl(n)),o=Ext.apply(u||{},{url:n,params:typeof t=="function"&&e?t.createDelegate(e):t,success:this.processSuccess,failure:this.processFailure,scope:this,callback:undefined,timeout:this.timeout*1e3,argument:{options:u,url:n,form:null,callback:i,scope:e||window,params:t}}),this.transaction=Ext.Ajax.request(o))},formUpdate:function(n,t,i,r){this.fireEvent("beforeupdate",this.el,n,t)!==!1&&(typeof t=="function"&&(t=t.call(this)),n=Ext.getDom(n),this.transaction=Ext.Ajax.request({form:n,url:t,success:this.processSuccess,failure:this.processFailure,scope:this,timeout:this.timeout*1e3,argument:{url:t,form:n,callback:r,reset:i}}),this.showLoading.defer(1,this))},refresh:function(n){this.defaultUrl!=null&&this.update(this.defaultUrl,null,n,!0)},startAutoRefresh:function(n,t,i,r,u){u&&this.update(t||this.defaultUrl,i,r,!0);this.autoRefreshProcId&&clearInterval(this.autoRefreshProcId);this.autoRefreshProcId=setInterval(this.update.createDelegate(this,[t||this.defaultUrl,i,r,!0]),n*1e3)},stopAutoRefresh:function(){this.autoRefreshProcId&&(clearInterval(this.autoRefreshProcId),delete this.autoRefreshProcId)},isAutoRefreshing:function(){return this.autoRefreshProcId?!0:!1},showLoading:function(){this.showLoadIndicator&&this.el.update(this.indicatorText)},prepareUrl:function(n){if(this.disableCaching){var t="_dc="+(new Date).getTime();n+=n.indexOf("?")!==-1?"&"+t:"?"+t}return n},processSuccess:function(n){if(this.transaction=null,n.argument.form&&n.argument.reset)try{n.argument.form.reset()}catch(t){}this.loadScripts?this.renderer.render(this.el,n,this,this.updateComplete.createDelegate(this,[n])):(this.renderer.render(this.el,n,this),this.updateComplete(n))},updateComplete:function(n){this.fireEvent("update",this.el,n);typeof n.argument.callback=="function"&&n.argument.callback.call(n.argument.scope,this.el,!0,n,n.argument.options)},processFailure:function(n){this.transaction=null;this.fireEvent("failure",this.el,n);typeof n.argument.callback=="function"&&n.argument.callback.call(n.argument.scope,this.el,!1,n,n.argument.options)},setRenderer:function(n){this.renderer=n},getRenderer:function(){return this.renderer},setDefaultUrl:function(n){this.defaultUrl=n},abort:function(){this.transaction&&Ext.Ajax.abort(this.transaction)},isUpdating:function(){return this.transaction?Ext.Ajax.isLoading(this.transaction):!1}});Ext.Updater.defaults={timeout:30,loadScripts:!1,sslBlankUrl:Ext.SSL_SECURE_URL||"javascript:false",disableCaching:!1,showLoadIndicator:!0,indicatorText:'<div class="loading-indicator">Loading...<\/div>'};Ext.Updater.updateElement=function(n,t,i,r){var u=Ext.get(n).getUpdater();Ext.apply(u,r);u.update(t,i,r?r.callback:null)};Ext.Updater.update=Ext.Updater.updateElement;Ext.Updater.BasicRenderer=function(){};Ext.Updater.BasicRenderer.prototype={render:function(n,t,i,r){n.update(t.responseText,i.loadScripts,r)}};Ext.UpdateManager=Ext.Updater