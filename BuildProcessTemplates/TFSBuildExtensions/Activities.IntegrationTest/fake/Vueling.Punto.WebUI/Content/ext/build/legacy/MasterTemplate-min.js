Ext.MasterTemplate=function(){var t,r,u,n,i,f;for(Ext.MasterTemplate.superclass.constructor.apply(this,arguments),this.originalHtml=this.html,t={},u=this.subTemplateRe,u.lastIndex=0,n=0;r=u.exec(this.html);)i=r[1],f=r[2],t[n]={name:i,index:n,buffer:[],tpl:new Ext.Template(f)},i&&(t[i]=t[n]),t[n].tpl.compile(),t[n].tpl.call=this.call.createDelegate(this),n++;this.subCount=n;this.subs=t};Ext.extend(Ext.MasterTemplate,Ext.Template,{subTemplateRe:/<tpl(?:\sname="([\w-]+)")?>((?:.|\n)*?)<\/tpl>/gi,add:function(n,t){arguments.length==1&&(t=arguments[0],n=0);var i=this.subs[n];return i.buffer[i.buffer.length]=i.tpl.apply(t),this},fill:function(n,t,i){var r=arguments,u,f;for((r.length==1||r.length==2&&typeof r[1]=="boolean")&&(t=r[0],n=0,i=r[1]),i&&this.reset(),u=0,f=t.length;u<f;u++)this.add(n,t[u]);return this},reset:function(){for(var t=this.subs,n=0;n<this.subCount;n++)t[n].buffer=[];return this},applyTemplate:function(n){var t=this.subs,i=-1;return this.html=this.originalHtml.replace(this.subTemplateRe,function(){return t[++i].buffer.join("")}),Ext.MasterTemplate.superclass.applyTemplate.call(this,n)},apply:function(){return this.applyTemplate.apply(this,arguments)},compile:function(){return this}});Ext.MasterTemplate.prototype.addAll=Ext.MasterTemplate.prototype.fill;Ext.MasterTemplate.from=function(n,t){return n=Ext.getDom(n),new Ext.MasterTemplate(n.value||n.innerHTML,t||"")}