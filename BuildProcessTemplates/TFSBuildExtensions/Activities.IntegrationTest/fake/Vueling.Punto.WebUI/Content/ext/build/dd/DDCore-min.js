(function(){var n=Ext.EventManager,t=Ext.lib.Dom;Ext.dd.DragDrop=function(n,t,i){n&&this.init(n,t,i)};Ext.dd.DragDrop.prototype={id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:!1,lock:function(){this.locked=!0},unlock:function(){this.locked=!1},isTarget:!0,padding:null,_domRef:null,__ygDragDrop:!0,constrainX:!1,constrainY:!1,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:!1,xTicks:null,yTicks:null,primaryButtonOnly:!0,available:!1,hasOuterHandles:!1,b4StartDrag:function(){},startDrag:function(){},b4Drag:function(){},onDrag:function(){},onDragEnter:function(){},b4DragOver:function(){},onDragOver:function(){},b4DragOut:function(){},onDragOut:function(){},b4DragDrop:function(){},onDragDrop:function(){},onInvalidDrop:function(){},b4EndDrag:function(){},endDrag:function(){},b4MouseDown:function(){},onMouseDown:function(){},onMouseUp:function(){},onAvailable:function(){},defaultPadding:{left:0,right:0,top:0,bottom:0},constrainTo:function(n,t){var o,s,h;typeof t=="number"&&(t={left:t,right:t,top:t,bottom:t});t=t||this.defaultPadding;var r=Ext.get(this.getEl()).getBox(),f=Ext.get(n),u=f.getScroll(),i,e=f.dom;e==document.body?i={x:u.left,y:u.top,width:Ext.lib.Dom.getViewWidth(),height:Ext.lib.Dom.getViewHeight()}:(o=f.getXY(),i={x:o[0]+u.left,y:o[1]+u.top,width:e.clientWidth,height:e.clientHeight});s=r.y-i.y;h=r.x-i.x;this.resetConstraints();this.setXConstraint(h-(t.left||0),i.width-h-r.width-(t.right||0),this.xTickSize);this.setYConstraint(s-(t.top||0),i.height-s-r.height-(t.bottom||0),this.yTickSize)},getEl:function(){return this._domRef||(this._domRef=Ext.getDom(this.id)),this._domRef},getDragEl:function(){return Ext.getDom(this.dragElId)},init:function(t,i,r){this.initTarget(t,i,r);n.on(this.id,"mousedown",this.handleMouseDown,this)},initTarget:function(n,t,i){this.config=i||{};this.DDM=Ext.dd.DDM;this.groups={};typeof n!="string"&&(n=Ext.id(n));this.id=n;this.addToGroup(t?t:"default");this.handleElId=n;this.setDragElId(n);this.invalidHandleTypes={A:"A"};this.invalidHandleIds={};this.invalidHandleClasses=[];this.applyConfig();this.handleOnAvailable()},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0];this.isTarget=this.config.isTarget!==!1;this.maintainOffset=this.config.maintainOffset;this.primaryButtonOnly=this.config.primaryButtonOnly!==!1},handleOnAvailable:function(){this.available=!0;this.resetConstraints();this.onAvailable()},setPadding:function(n,t,i,r){this.padding=t||0===t?i||0===i?[n,t,i,r]:[n,t,n,t]:[n,n,n,n]},setInitPosition:function(n,i){var u=this.getEl();if(this.DDM.verifyEl(u)){var f=n||0,e=i||0,r=t.getXY(u);this.initPageX=r[0]-f;this.initPageY=r[1]-e;this.lastPageX=r[0];this.lastPageY=r[1];this.setStartPosition(r)}},setStartPosition:function(n){var i=n||t.getXY(this.getEl());this.deltaSetXY=null;this.startPageX=i[0];this.startPageY=i[1]},addToGroup:function(n){this.groups[n]=!0;this.DDM.regDragDrop(this,n)},removeFromGroup:function(n){this.groups[n]&&delete this.groups[n];this.DDM.removeDDFromGroup(this,n)},setDragElId:function(n){this.dragElId=n},setHandleElId:function(n){typeof n!="string"&&(n=Ext.id(n));this.handleElId=n;this.DDM.regHandle(this.id,n)},setOuterHandleElId:function(t){typeof t!="string"&&(t=Ext.id(t));n.on(t,"mousedown",this.handleMouseDown,this);this.setHandleElId(t);this.hasOuterHandles=!0},unreg:function(){n.un(this.id,"mousedown",this.handleMouseDown);this._domRef=null;this.DDM._remove(this)},destroy:function(){this.unreg()},isLocked:function(){return this.DDM.isLocked()||this.locked},handleMouseDown:function(n){if((!this.primaryButtonOnly||n.button==0)&&!this.isLocked()){this.DDM.refreshCache(this.groups);var t=new Ext.lib.Point(Ext.lib.Event.getPageX(n),Ext.lib.Event.getPageY(n));if((this.hasOuterHandles||this.DDM.isOverTarget(t,this))&&this.clickValidator(n)){this.setStartPosition();this.b4MouseDown(n);this.onMouseDown(n);this.DDM.handleMouseDown(n,this);this.DDM.stopEvent(n)}}},clickValidator:function(n){var t=n.getTarget();return this.isValidHandleChild(t)&&(this.id==this.handleElId||this.DDM.handleWasClicked(t,this.id))},addInvalidHandleType:function(n){var t=n.toUpperCase();this.invalidHandleTypes[t]=t},addInvalidHandleId:function(n){typeof n!="string"&&(n=Ext.id(n));this.invalidHandleIds[n]=n},addInvalidHandleClass:function(n){this.invalidHandleClasses.push(n)},removeInvalidHandleType:function(n){var t=n.toUpperCase();delete this.invalidHandleTypes[t]},removeInvalidHandleId:function(n){typeof n!="string"&&(n=Ext.id(n));delete this.invalidHandleIds[n]},removeInvalidHandleClass:function(n){for(var t=0,i=this.invalidHandleClasses.length;t<i;++t)this.invalidHandleClasses[t]==n&&delete this.invalidHandleClasses[t]},isValidHandleChild:function(n){var i=!0,u,r,f;try{u=n.nodeName.toUpperCase()}catch(e){u=n.nodeName}for(i=i&&!this.invalidHandleTypes[u],i=i&&!this.invalidHandleIds[n.id],r=0,f=this.invalidHandleClasses.length;i&&r<f;++r)i=!t.hasClass(n,this.invalidHandleClasses[r]);return i},setXTicks:function(n,t){var r,i;for(this.xTicks=[],this.xTickSize=t,r={},i=this.initPageX;i>=this.minX;i=i-t)r[i]||(this.xTicks[this.xTicks.length]=i,r[i]=!0);for(i=this.initPageX;i<=this.maxX;i=i+t)r[i]||(this.xTicks[this.xTicks.length]=i,r[i]=!0);this.xTicks.sort(this.DDM.numericSort)},setYTicks:function(n,t){var r,i;for(this.yTicks=[],this.yTickSize=t,r={},i=this.initPageY;i>=this.minY;i=i-t)r[i]||(this.yTicks[this.yTicks.length]=i,r[i]=!0);for(i=this.initPageY;i<=this.maxY;i=i+t)r[i]||(this.yTicks[this.yTicks.length]=i,r[i]=!0);this.yTicks.sort(this.DDM.numericSort)},setXConstraint:function(n,t,i){this.leftConstraint=n;this.rightConstraint=t;this.minX=this.initPageX-n;this.maxX=this.initPageX+t;i&&this.setXTicks(this.initPageX,i);this.constrainX=!0},clearConstraints:function(){this.constrainX=!1;this.constrainY=!1;this.clearTicks()},clearTicks:function(){this.xTicks=null;this.yTicks=null;this.xTickSize=0;this.yTickSize=0},setYConstraint:function(n,t,i){this.topConstraint=n;this.bottomConstraint=t;this.minY=this.initPageY-n;this.maxY=this.initPageY+t;i&&this.setYTicks(this.initPageY,i);this.constrainY=!0},resetConstraints:function(){if(this.initPageX||this.initPageX===0){var n=this.maintainOffset?this.lastPageX-this.initPageX:0,t=this.maintainOffset?this.lastPageY-this.initPageY:0;this.setInitPosition(n,t)}else this.setInitPosition();this.constrainX&&this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize);this.constrainY&&this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize)},getTick:function(n,t){var i,u,r,f,e;if(t){if(t[0]>=n)return t[0];for(i=0,u=t.length;i<u;++i)if(r=i+1,t[r]&&t[r]>=n)return f=n-t[i],e=t[r]-n,e>f?t[i]:t[r];return t[t.length-1]}return n},toString:function(){return"DragDrop "+this.id}}})();Ext.dd.DragDropMgr||(Ext.dd.DragDropMgr=function(){var n=Ext.EventManager;return{ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:!0,stopPropagation:!0,initalized:!1,locked:!1,init:function(){this.initialized=!0},POINT:0,INTERSECT:1,mode:0,_execOnAll:function(n,t){var r,u,i;for(r in this.ids)for(u in this.ids[r])(i=this.ids[r][u],this.isTypeOfDD(i))&&i[n].apply(i,t)},_onLoad:function(){this.init();n.on(document,"mouseup",this.handleMouseUp,this,!0);n.on(document,"mousemove",this.handleMouseMove,this,!0);n.on(window,"unload",this._onUnload,this,!0);n.on(window,"resize",this._onResize,this,!0)},_onResize:function(){this._execOnAll("resetConstraints",[])},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},isLocked:function(){return this.locked},locationCache:{},useCache:!0,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:!1,clickTimeout:null,startX:0,startY:0,regDragDrop:function(n,t){this.initialized||this.init();this.ids[t]||(this.ids[t]={});this.ids[t][n.id]=n},removeDDFromGroup:function(n,t){this.ids[t]||(this.ids[t]={});var i=this.ids[t];i&&i[n.id]&&delete i[n.id]},_remove:function(n){for(var t in n.groups)t&&this.ids[t][n.id]&&delete this.ids[t][n.id];delete this.handleIds[n.id]},regHandle:function(n,t){this.handleIds[n]||(this.handleIds[n]={});this.handleIds[n][t]=t},isDragDrop:function(n){return this.getDDById(n)?!0:!1},getRelated:function(n,t){var r=[],u,i;for(u in n.groups)for(j in this.ids[u])(i=this.ids[u][j],this.isTypeOfDD(i))&&(!t||i.isTarget)&&(r[r.length]=i);return r},isLegalTarget:function(n,t){for(var r=this.getRelated(n,!0),i=0,u=r.length;i<u;++i)if(r[i].id==t.id)return!0;return!1},isTypeOfDD:function(n){return n&&n.__ygDragDrop},isHandle:function(n,t){return this.handleIds[n]&&this.handleIds[n][t]},getDDById:function(n){for(var t in this.ids)if(this.ids[t][n])return this.ids[t][n];return null},handleMouseDown:function(n,t){Ext.QuickTips&&Ext.QuickTips.disable();this.currentTarget=n.getTarget();this.dragCurrent=t;var i=t.getEl();this.startX=n.getPageX();this.startY=n.getPageY();this.deltaX=this.startX-i.offsetLeft;this.deltaY=this.startY-i.offsetTop;this.dragThreshMet=!1;this.clickTimeout=setTimeout(function(){var n=Ext.dd.DDM;n.startDrag(n.startX,n.startY)},this.clickTimeThresh)},startDrag:function(n,t){clearTimeout(this.clickTimeout);this.dragCurrent&&(this.dragCurrent.b4StartDrag(n,t),this.dragCurrent.startDrag(n,t));this.dragThreshMet=!0},handleMouseUp:function(n){(Ext.QuickTips&&Ext.QuickTips.enable(),this.dragCurrent)&&(clearTimeout(this.clickTimeout),this.dragThreshMet&&this.fireEvents(n,!0),this.stopDrag(n),this.stopEvent(n))},stopEvent:function(n){this.stopPropagation&&n.stopPropagation();this.preventDefault&&n.preventDefault()},stopDrag:function(n){if(this.dragCurrent){this.dragThreshMet&&(this.dragCurrent.b4EndDrag(n),this.dragCurrent.endDrag(n));this.dragCurrent.onMouseUp(n)}this.dragCurrent=null;this.dragOvers={}},handleMouseMove:function(n){if(!this.dragCurrent)return!0;if(Ext.isIE&&n.button!==0&&n.button!==1&&n.button!==2)return this.stopEvent(n),this.handleMouseUp(n);if(!this.dragThreshMet){var t=Math.abs(this.startX-n.getPageX()),i=Math.abs(this.startY-n.getPageY());(t>this.clickPixelThresh||i>this.clickPixelThresh)&&this.startDrag(this.startX,this.startY)}if(this.dragThreshMet){this.dragCurrent.b4Drag(n);this.dragCurrent.onDrag(n);this.dragCurrent.moveOnly||this.fireEvents(n,!1)}return this.stopEvent(n),!0},fireEvents:function(n,t){var r=this.dragCurrent,i,c,l,u,f;if(r&&!r.isLocked()){var a=n.getPoint(),v=[],o=[],s=[],e=[],h=[];for(i in this.dragOvers)(c=this.dragOvers[i],this.isTypeOfDD(c))&&(this.isOverTarget(a,c,this.mode)||o.push(c),v[i]=!0,delete this.dragOvers[i]);for(l in r.groups)if("string"==typeof l)for(i in this.ids[l])(u=this.ids[l][i],this.isTypeOfDD(u))&&u.isTarget&&!u.isLocked()&&u!=r&&this.isOverTarget(a,u,this.mode)&&(t?e.push(u):(v[u.id]?s.push(u):h.push(u),this.dragOvers[u.id]=u));if(this.mode){if(o.length){r.b4DragOut(n,o);r.onDragOut(n,o)}if(h.length)r.onDragEnter(n,h);if(s.length){r.b4DragOver(n,s);r.onDragOver(n,s)}if(e.length){r.b4DragDrop(n,e);r.onDragDrop(n,e)}}else{for(f=0,i=0,f=o.length;i<f;++i){r.b4DragOut(n,o[i].id);r.onDragOut(n,o[i].id)}for(i=0,f=h.length;i<f;++i)r.onDragEnter(n,h[i].id);for(i=0,f=s.length;i<f;++i){r.b4DragOver(n,s[i].id);r.onDragOver(n,s[i].id)}for(i=0,f=e.length;i<f;++i){r.b4DragDrop(n,e[i].id);r.onDragDrop(n,e[i].id)}}if(t&&!e.length)r.onInvalidDrop(n)}},getBestMatch:function(n){var t=null,u=n.length,r,i;if(u==1)t=n[0];else for(r=0;r<u;++r)if(i=n[r],i.cursorIsOver){t=i;break}else(!t||t.overlap.getArea()<i.overlap.getArea())&&(t=i);return t},refreshCache:function(n){var i,u,t,r;for(i in n)if("string"==typeof i)for(u in this.ids[i])t=this.ids[i][u],this.isTypeOfDD(t)&&(r=this.getLocation(t),r?this.locationCache[t.id]=r:delete this.locationCache[t.id])},verifyEl:function(n){if(n){var t;if(Ext.isIE)try{t=n.offsetParent}catch(i){}else t=n.offsetParent;if(t)return!0}return!1},getLocation:function(n){if(!this.isTypeOfDD(n))return null;var i=n.getEl(),t,r,f,u,e,o,s,h,c;try{t=Ext.lib.Dom.getXY(i)}catch(l){}return t?(r=t[0],f=r+i.offsetWidth,u=t[1],e=u+i.offsetHeight,o=u-n.padding[0],s=f+n.padding[1],h=e+n.padding[2],c=r-n.padding[3],new Ext.lib.Region(o,s,h,c)):null},isOverTarget:function(n,t,i){var u=this.locationCache[t.id],r;if(u&&this.useCache||(u=this.getLocation(t),this.locationCache[t.id]=u),!u)return!1;if(t.cursorIsOver=u.contains(n),r=this.dragCurrent,!r||!r.getTargetCoord||!i&&!r.constrainX&&!r.constrainY)return t.cursorIsOver;t.overlap=null;var f=r.getTargetCoord(n.x,n.y),e=r.getDragEl(),s=new Ext.lib.Region(f.y,f.x+e.offsetWidth,f.y+e.offsetHeight,f.x),o=s.intersect(u);return o?(t.overlap=o,i?!0:t.cursorIsOver):!1},_onUnload:function(){Ext.dd.DragDropMgr.unregAll()},unregAll:function(){this.dragCurrent&&(this.stopDrag(),this.dragCurrent=null);this._execOnAll("unreg",[]);for(var n in this.elementCache)delete this.elementCache[n];this.elementCache={};this.ids={}},elementCache:{},getElWrapper:function(n){var t=this.elementCache[n];return t&&t.el||(t=this.elementCache[n]=new this.ElementWrapper(Ext.getDom(n))),t},getElement:function(n){return Ext.getDom(n)},getCss:function(n){var t=Ext.getDom(n);return t?t.style:null},ElementWrapper:function(n){this.el=n||null;this.id=this.el&&n.id;this.css=this.el&&n.style},getPosX:function(n){return Ext.lib.Dom.getX(n)},getPosY:function(n){return Ext.lib.Dom.getY(n)},swapNode:function(n,t){if(n.swapNode)n.swapNode(t);else{var i=t.parentNode,r=t.nextSibling;r==n?i.insertBefore(n,t):t==n.nextSibling?i.insertBefore(t,n):(n.parentNode.replaceChild(t,n),i.insertBefore(n,r))}},getScroll:function(){var t,i,n=document.documentElement,r=document.body;return n&&(n.scrollTop||n.scrollLeft)?(t=n.scrollTop,i=n.scrollLeft):r&&(t=r.scrollTop,i=r.scrollLeft),{top:t,left:i}},getStyle:function(n,t){return Ext.fly(n).getStyle(t)},getScrollTop:function(){return this.getScroll().top},getScrollLeft:function(){return this.getScroll().left},moveToEl:function(n,t){var i=Ext.lib.Dom.getXY(t);Ext.lib.Dom.setXY(n,i)},numericSort:function(n,t){return n-t},_timeoutCount:0,_addListeners:function(){var n=Ext.dd.DDM;Ext.lib.Event&&document?n._onLoad():n._timeoutCount>2e3||(setTimeout(n._addListeners,10),document&&document.body&&(n._timeoutCount+=1))},handleWasClicked:function(n,t){if(this.isHandle(t,n.id))return!0;for(var i=n.parentNode;i;){if(this.isHandle(t,i.id))return!0;i=i.parentNode}return!1}}}(),Ext.dd.DDM=Ext.dd.DragDropMgr,Ext.dd.DDM._addListeners());Ext.dd.DD=function(n,t,i){n&&this.init(n,t,i)};Ext.extend(Ext.dd.DD,Ext.dd.DragDrop,{scroll:!0,autoOffset:function(n,t){var i=n-this.startPageX,r=t-this.startPageY;this.setDelta(i,r)},setDelta:function(n,t){this.deltaX=n;this.deltaY=t},setDragElPos:function(n,t){var i=this.getDragEl();this.alignElWithMouse(i,n,t)},alignElWithMouse:function(n,t,i){var r=this.getTargetCoord(t,i),u=n.dom?n:Ext.fly(n,"_dd"),f,e,o;return this.deltaSetXY?u.setLeftTop(r.x+this.deltaSetXY[0],r.y+this.deltaSetXY[1]):(f=[r.x,r.y],u.setXY(f),e=u.getLeft(!0),o=u.getTop(!0),this.deltaSetXY=[e-r.x,o-r.y]),this.cachePosition(r.x,r.y),this.autoScroll(r.x,r.y,n.offsetHeight,n.offsetWidth),r},cachePosition:function(n,t){if(n)this.lastPageX=n,this.lastPageY=t;else{var i=Ext.lib.Dom.getXY(this.getEl());this.lastPageX=i[0];this.lastPageY=i[1]}},autoScroll:function(n,t,i,r){if(this.scroll){var s=Ext.lib.Dom.getViewHeight(),h=Ext.lib.Dom.getViewWidth(),u=this.DDM.getScrollTop(),f=this.DDM.getScrollLeft(),c=i+t,l=r+n,a=s+u-t-this.deltaY,v=h+f-n-this.deltaX,e=40,o=document.all?80:30;c>s&&a<e&&window.scrollTo(f,u+o);t<u&&u>0&&t-u<e&&window.scrollTo(f,u-o);l>h&&v<e&&window.scrollTo(f+o,u);n<f&&f>0&&n-f<e&&window.scrollTo(f-o,u)}},getTargetCoord:function(n,t){var i=n-this.deltaX,r=t-this.deltaY;return this.constrainX&&(i<this.minX&&(i=this.minX),i>this.maxX&&(i=this.maxX)),this.constrainY&&(r<this.minY&&(r=this.minY),r>this.maxY&&(r=this.maxY)),i=this.getTick(i,this.xTicks),r=this.getTick(r,this.yTicks),{x:i,y:r}},applyConfig:function(){Ext.dd.DD.superclass.applyConfig.call(this);this.scroll=this.config.scroll!==!1},b4MouseDown:function(n){this.autoOffset(n.getPageX(),n.getPageY())},b4Drag:function(n){this.setDragElPos(n.getPageX(),n.getPageY())},toString:function(){return"DD "+this.id}});Ext.dd.DDProxy=function(n,t,i){n&&(this.init(n,t,i),this.initFrame())};Ext.dd.DDProxy.dragElId="ygddfdiv";Ext.extend(Ext.dd.DDProxy,Ext.dd.DD,{resizeFrame:!0,centerFrame:!1,createFrame:function(){var r=this,i=document.body,n,t;if(!i||!i.firstChild){setTimeout(function(){r.createFrame()},50);return}n=this.getDragEl();n||(n=document.createElement("div"),n.id=this.dragElId,t=n.style,t.position="absolute",t.visibility="hidden",t.cursor="move",t.border="2px solid #aaa",t.zIndex=999,i.insertBefore(n,i.firstChild))},initFrame:function(){this.createFrame()},applyConfig:function(){Ext.dd.DDProxy.superclass.applyConfig.call(this);this.resizeFrame=this.config.resizeFrame!==!1;this.centerFrame=this.config.centerFrame;this.setDragElId(this.config.dragElId||Ext.dd.DDProxy.dragElId)},showFrame:function(n,t){var u=this.getEl(),i=this.getDragEl(),r=i.style;this._resizeProxy();this.centerFrame&&this.setDelta(Math.round(parseInt(r.width,10)/2),Math.round(parseInt(r.height,10)/2));this.setDragElPos(n,t);Ext.fly(i).show()},_resizeProxy:function(){if(this.resizeFrame){var n=this.getEl();Ext.fly(this.getDragEl()).setSize(n.offsetWidth,n.offsetHeight)}},b4MouseDown:function(n){var t=n.getPageX(),i=n.getPageY();this.autoOffset(t,i);this.setDragElPos(t,i)},b4StartDrag:function(n,t){this.showFrame(n,t)},b4EndDrag:function(){Ext.fly(this.getDragEl()).hide()},endDrag:function(){var n=this.getEl(),t=this.getDragEl();t.style.visibility="";this.beforeMove();n.style.visibility="hidden";Ext.dd.DDM.moveToEl(n,t);t.style.visibility="hidden";n.style.visibility="";this.afterDrag()},beforeMove:function(){},afterDrag:function(){},toString:function(){return"DDProxy "+this.id}});Ext.dd.DDTarget=function(n,t,i){n&&this.initTarget(n,t,i)};Ext.extend(Ext.dd.DDTarget,Ext.dd.DragDrop,{toString:function(){return"DDTarget "+this.id}})