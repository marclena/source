Ext.dd.DragTracker=function(n){Ext.apply(this,n);this.addEvents("mousedown","mouseup","mousemove","dragstart","dragend","drag");this.dragRegion=new Ext.lib.Region(0,0,0,0);this.el&&this.initEl(this.el)};Ext.extend(Ext.dd.DragTracker,Ext.util.Observable,{active:!1,tolerance:5,autoStart:!1,initEl:function(n){this.el=Ext.get(n);n.on("mousedown",this.onMouseDown,this,this.delegate?{delegate:this.delegate}:undefined)},destroy:function(){this.el.un("mousedown",this.onMouseDown,this)},onMouseDown:function(n,t){if(this.fireEvent("mousedown",this,n)!==!1&&this.onBeforeStart(n)!==!1){this.startXY=this.lastXY=n.getXY();this.dragTarget=this.delegate?t:this.el.dom;n.preventDefault();var i=Ext.getDoc();i.on("mouseup",this.onMouseUp,this);i.on("mousemove",this.onMouseMove,this);i.on("selectstart",this.stopSelect,this);this.autoStart&&(this.timer=this.triggerStart.defer(this.autoStart===!0?1e3:this.autoStart,this))}},onMouseMove:function(n){n.preventDefault();var t=n.getXY(),i=this.startXY;if(this.lastXY=t,!this.active)if(Math.abs(i[0]-t[0])>this.tolerance||Math.abs(i[1]-t[1])>this.tolerance)this.triggerStart();else return;this.fireEvent("mousemove",this,n);this.onDrag(n);this.fireEvent("drag",this,n)},onMouseUp:function(n){var t=Ext.getDoc();t.un("mousemove",this.onMouseMove,this);t.un("mouseup",this.onMouseUp,this);t.un("selectstart",this.stopSelect,this);n.preventDefault();this.clearStart();this.active=!1;delete this.elRegion;this.fireEvent("mouseup",this,n);this.onEnd(n);this.fireEvent("dragend",this,n)},triggerStart:function(){this.clearStart();this.active=!0;this.onStart(this.startXY);this.fireEvent("dragstart",this,this.startXY)},clearStart:function(){this.timer&&(clearTimeout(this.timer),delete this.timer)},stopSelect:function(n){return n.stopEvent(),!1},onBeforeStart:function(){},onStart:function(){},onDrag:function(){},onEnd:function(){},getDragTarget:function(){return this.dragTarget},getDragCt:function(){return this.el},getXY:function(n){return n?this.constrainModes[n].call(this,this.lastXY):this.lastXY},getOffset:function(n){var t=this.getXY(n),i=this.startXY;return[i[0]-t[0],i[1]-t[1]]},constrainModes:{point:function(n){this.elRegion||(this.elRegion=this.getDragCt().getRegion());var t=this.dragRegion;return t.left=n[0],t.top=n[1],t.right=n[0],t.bottom=n[1],t.constrainTo(this.elRegion),[t.left,t.top]}}})