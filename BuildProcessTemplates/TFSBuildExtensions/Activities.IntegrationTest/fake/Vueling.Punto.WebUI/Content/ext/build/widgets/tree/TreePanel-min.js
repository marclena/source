Ext.tree.TreePanel=Ext.extend(Ext.Panel,{rootVisible:!0,animate:Ext.enableFx,lines:!0,enableDD:!1,hlDrop:Ext.enableFx,pathSeparator:"/",initComponent:function(){if(Ext.tree.TreePanel.superclass.initComponent.call(this),this.eventModel||(this.eventModel=new Ext.tree.TreeEventModel(this)),this.nodeHash={},this.root&&this.setRootNode(this.root),this.addEvents("append","remove","movenode","insert","beforeappend","beforeremove","beforemovenode","beforeinsert","beforeload","load","textchange","beforeexpandnode","beforecollapsenode","expandnode","disabledchange","collapsenode","beforeclick","click","checkchange","dblclick","contextmenu","beforechildrenrendered","startdrag","enddrag","dragdrop","beforenodedrop","nodedrop","nodedragover"),this.singleExpand)this.on("beforeexpandnode",this.restrictExpand,this)},proxyNodeEvent:function(n,t,i,r,u,f,e){return(n=="collapse"||n=="expand"||n=="beforecollapse"||n=="beforeexpand"||n=="move"||n=="beforemove")&&(n=n+"node"),this.fireEvent(n,t,i,r,u,f,e)},getRootNode:function(){return this.root},setRootNode:function(n){if(this.root=n,n.ownerTree=this,n.isRoot=!0,this.registerNode(n),!this.rootVisible){var t=n.attributes.uiProvider;n.ui=t?new t(n):new Ext.tree.RootTreeNodeUI(n)}return n},getNodeById:function(n){return this.nodeHash[n]},registerNode:function(n){this.nodeHash[n.id]=n},unregisterNode:function(n){delete this.nodeHash[n.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"},restrictExpand:function(n){var t=n.parentNode;t&&(t.expandedChild&&t.expandedChild.parentNode==t&&t.expandedChild.collapse(),t.expandedChild=n)},getChecked:function(n,t){t=t||this.root;var i=[],r=function(){this.attributes.checked&&i.push(n?n=="id"?this.id:this.attributes[n]:this)};return t.cascade(r),i},getEl:function(){return this.el},getLoader:function(){return this.loader},expandAll:function(){this.root.expand(!0)},collapseAll:function(){this.root.collapse(!0)},getSelectionModel:function(){return this.selModel||(this.selModel=new Ext.tree.DefaultSelectionModel),this.selModel},expandPath:function(n,t,i){var u,r,f,e;if(t=t||"id",u=n.split(this.pathSeparator),r=this.root,r.attributes[t]!=u[1]){i&&i(!1,null);return}f=1;e=function(){if(++f==u.length){i&&i(!0,r);return}var n=r.findChild(t,u[f]);if(!n){i&&i(!1,r);return}r=n;n.expand(!1,!1,e)};r.expand(!1,!1,e)},selectPath:function(n,t,i){var r,u,f;t=t||"id";r=n.split(this.pathSeparator);u=r.pop();r.length>0?(f=function(n,r){if(n&&r){var f=r.findChild(t,u);f?(f.select(),i&&i(!0,f)):i&&i(!1,f)}else i&&i(!1,f)},this.expandPath(r.join(this.pathSeparator),t,f)):(this.root.select(),i&&i(!0,this.root))},getTreeEl:function(){return this.body},onRender:function(n,t){Ext.tree.TreePanel.superclass.onRender.call(this,n,t);this.el.addClass("x-tree");this.innerCt=this.body.createChild({tag:"ul",cls:"x-tree-root-ct "+(this.lines?"x-tree-lines":"x-tree-no-lines")})},initEvents:function(){Ext.tree.TreePanel.superclass.initEvents.call(this);this.containerScroll&&Ext.dd.ScrollManager.register(this.body);(this.enableDD||this.enableDrop)&&!this.dropZone&&(this.dropZone=new Ext.tree.TreeDropZone(this,this.dropConfig||{ddGroup:this.ddGroup||"TreeDD",appendOnly:this.ddAppendOnly===!0}));(this.enableDD||this.enableDrag)&&!this.dragZone&&(this.dragZone=new Ext.tree.TreeDragZone(this,this.dragConfig||{ddGroup:this.ddGroup||"TreeDD",scroll:this.ddScroll}));this.getSelectionModel().init(this)},afterRender:function(){Ext.tree.TreePanel.superclass.afterRender.call(this);this.root.render();this.rootVisible||this.root.renderChildren()},onDestroy:function(){this.rendered&&(this.body.removeAllListeners(),Ext.dd.ScrollManager.unregister(this.body),this.dropZone&&this.dropZone.unreg(),this.dragZone&&this.dragZone.unreg());this.root.destroy();this.nodeHash=null;Ext.tree.TreePanel.superclass.onDestroy.call(this)}});Ext.reg("treepanel",Ext.tree.TreePanel)